{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/maupassant/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/jquery.fancybox.css","path":"css/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/maupassant/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/maupassant/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/maupassant/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/style.scss","path":"css/style.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/maupassant/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/fancybox.js","path":"js/fancybox.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","path":"js/codeblock-resizer.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/share.js","path":"js/share.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/smartresize.js","path":"js/smartresize.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/totop.js","path":"js/totop.js","modified":0,"renderable":1}],"Cache":[{"_id":"themes/maupassant/.travis.yml","hash":"0339959f29deddc365e8fe8bd85da524410b9a23","modified":1498441458000},{"_id":"themes/maupassant/LICENSE","hash":"019dc6a9aba02ae3aaabca45f39aecd6e8e7f1d8","modified":1498441458000},{"_id":"themes/maupassant/README.md","hash":"75d8c42569809961953d1934de445418c00ab94c","modified":1498441458000},{"_id":"themes/maupassant/_config.yml","hash":"7f9abbd035a0c03435c9e89beaca912360cf1bca","modified":1498441458000},{"_id":"themes/maupassant/package.json","hash":"81fb4e2ac051ecfb9a93f37b28910291b939771a","modified":1498441458000},{"_id":"source/_posts/compile-cocosbuilder.md","hash":"51a3da491748bdf0f91010f1acc9a6856c992147","modified":1499160668000},{"_id":"source/_posts/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1498441606000},{"_id":"source/_posts/cocos-lua-debug.md","hash":"04abae3e4b8491fb4873126208b8a39fab8c6350","modified":1498441458000},{"_id":"source/_posts/electron-intr.md","hash":"13e9143e70cafce4f14278239fbbe29d04452a34","modified":1498441458000},{"_id":"source/_posts/electron-setup.md","hash":"552b34649c792e981bbd48190cecc25956d03242","modified":1498441458000},{"_id":"source/_posts/hello-world.md","hash":"9c520a9edf71f58842239d7b391d3da62eca5304","modified":1498441458000},{"_id":"source/_posts/pomelo.md","hash":"837bafc1b0b256cb0d59ea547a1e7a7ec52b87e4","modified":1498441458000},{"_id":"source/_posts/qq-mirr.md","hash":"ce407ddaf4b7d5c3fa57a914e9df1cbb8b3e1111","modified":1498441458000},{"_id":"source/_posts/storage.md","hash":"5361d87aea2e4ca34796f272b030cbb2b964cfa4","modified":1498441458000},{"_id":"source/_posts/style.md","hash":"160a1023f27e54eeace877590aaf1c3b796e3838","modified":1498441458000},{"_id":"source/_posts/websocket.md","hash":"75d0e40619d904eaffbfc36c308a1a4621989165","modified":1498441458000},{"_id":"themes/maupassant/languages/en.yml","hash":"e13ab1a2d2f1edbe67b4c035fd4667cb6a31db8e","modified":1498441458000},{"_id":"themes/maupassant/languages/es-ES.yml","hash":"58e1d04bcd1834fa9d2960e18e027abbbccbedc9","modified":1498441458000},{"_id":"themes/maupassant/languages/de-DE.yml","hash":"5d3556a885e355a8c2da65ef3e7b3ee36a628bfa","modified":1498441458000},{"_id":"themes/maupassant/languages/fr-FR.yml","hash":"b47906ec0abf867fb3e3360bc046b7afb68aee25","modified":1498441458000},{"_id":"themes/maupassant/languages/ko.yml","hash":"909a33e0befa6978e8e72157c6b415b48551ee31","modified":1498441458000},{"_id":"themes/maupassant/languages/zh-CN.yml","hash":"15e057ec4f23a49ed5b9ebf9b5ef6ad9a0a97a30","modified":1498441458000},{"_id":"themes/maupassant/languages/zh-TW.yml","hash":"56b65995c60e99dcebbf00168447fd225d28e5b2","modified":1498441458000},{"_id":"themes/maupassant/layout/archive.jade","hash":"0050c883b4f202add71c8664d65e6072179e7190","modified":1498441458000},{"_id":"themes/maupassant/layout/base-without-sidebar.jade","hash":"1ad721de96784bf4253316b796db6200148d4152","modified":1498441458000},{"_id":"themes/maupassant/layout/base.jade","hash":"852c610ac392ef2fa130dbe73bcf4f96f423c869","modified":1498441458000},{"_id":"themes/maupassant/layout/index.jade","hash":"7466ce52023ed8a413a6b4461354a9e20e62fc14","modified":1498441458000},{"_id":"themes/maupassant/layout/page.jade","hash":"8d70fd3b93f2c9087a9ea7ec538dcc1d413bea01","modified":1498441458000},{"_id":"themes/maupassant/layout/post.jade","hash":"9cf29fb0daed95935154ce0fa2b154df5a9b11b1","modified":1498441458000},{"_id":"themes/maupassant/layout/single-column.jade","hash":"c35fff4d9b331a41af5bc10f4278ec3d9da503db","modified":1498441458000},{"_id":"themes/maupassant/layout/timeline.jade","hash":"f03d8df63a188543cfe4e85e76194abe081411a1","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/after_footer.jade","hash":"3dbcc9a9f0d6e55da191d3393c18bbfcfe99fa69","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/comments.jade","hash":"6c7f63ba04a4d28323ba31e79a4927f3d3fcc56e","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/footer.jade","hash":"709e7481766cf67d98786aa9cb31eb441622ef6b","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/helpers.jade","hash":"acdf9e2d52ee86c831fa15ce1570930c5779bc78","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/mathjax.jade","hash":"b54b56faff9e47ab3ca3cdd55056c73e60776f3c","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/mathjax2.jade","hash":"d6ac5dc4e9c7a1b866f1f92d88988cfb35aded4c","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/paginator.jade","hash":"53f9cb77448e84a98da5eb688e2e12b173c555bb","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/post_nav.jade","hash":"a2d698c84bb6da08195fe870dbd7215f65388d3f","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/totop.jade","hash":"8225bbc3cdb9648bc2e6872e5c616a9a1e4def4f","modified":1498441458000},{"_id":"themes/maupassant/layout/_partial/tag.jade","hash":"0f0e6770e9d5dd8040e330d71bbbfadd2df36a28","modified":1498441458000},{"_id":"themes/maupassant/layout/_widget/links.jade","hash":"f57a0c76d243882b2b77330132bdb43bc648948b","modified":1498441458000},{"_id":"themes/maupassant/layout/_widget/category.jade","hash":"7c6aed762934ca51aa2669b886254da24b77bc14","modified":1498441458000},{"_id":"themes/maupassant/layout/_widget/recent_comments.jade","hash":"e119c5afa85abc60d139e2da99b0bfcd7a6530f8","modified":1498441458000},{"_id":"themes/maupassant/layout/_widget/recent_posts.jade","hash":"19431336d724d2118e46da43683bce9063176541","modified":1498441458000},{"_id":"themes/maupassant/layout/_widget/search.jade","hash":"193546282908e499813534f86d27ef6e0a1357b3","modified":1498441458000},{"_id":"themes/maupassant/layout/_widget/tag.jade","hash":"132f049ce677d0e38f50073174c4ee4b825d4a06","modified":1498441458000},{"_id":"themes/maupassant/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1498441458000},{"_id":"themes/maupassant/source/css/jquery.fancybox.css","hash":"f42f761157f26244673eb2f4a9215c70956f80dc","modified":1498441458000},{"_id":"themes/maupassant/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1498441458000},{"_id":"themes/maupassant/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1498441458000},{"_id":"themes/maupassant/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1498441458000},{"_id":"themes/maupassant/source/css/style.scss","hash":"ef196d0b60bbcfa58c70ecd1141cb793d88705a2","modified":1498441458000},{"_id":"themes/maupassant/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1498441458000},{"_id":"themes/maupassant/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1498441458000},{"_id":"themes/maupassant/source/js/fancybox.js","hash":"13c4781570339f4fba76a3d7f202e442817dd605","modified":1498441458000},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","hash":"5d0b786d60bf225d9eabcc9cece2719ff4d9b6cd","modified":1498441458000},{"_id":"themes/maupassant/source/js/search.js","hash":"53db2eb255dd40a412ed62ea7332ca5a22f7816f","modified":1498441458000},{"_id":"themes/maupassant/source/js/share.js","hash":"f49776e0baa2b913ddc7a20db24b3edd469c8343","modified":1498441458000},{"_id":"themes/maupassant/source/js/smartresize.js","hash":"3ef157fd877167e3290f42c67a624ea375a46c24","modified":1498441458000},{"_id":"themes/maupassant/source/js/totop.js","hash":"7dbf8fcf582a4fb6eb9b2c60d6de9f9c2091ec4c","modified":1498441458000},{"_id":"public/atom.xml","hash":"f14a651929f20cdf26f1edeb922797e38d27556f","modified":1499188094790},{"_id":"public/2017/06/pomelo/index.html","hash":"21eab289dbbcc67f4e5eb260bc8abfc267009ab3","modified":1499188094805},{"_id":"public/2017/03/cocos-lua-debug/index.html","hash":"42d80ac02cbc468d7e863986f23e5ab5edeb923c","modified":1499188094805},{"_id":"public/2017/02/storage/index.html","hash":"e0094afc7173f905649244fe89c4c045d30f196d","modified":1499188094805},{"_id":"public/2017/02/qq-mirr/index.html","hash":"7dd769a823f6710efcbdb76e09682fb0f8c67b8e","modified":1499188094806},{"_id":"public/2016/11/electron-setup/index.html","hash":"6d78b4c29217264fd450f4c8a110f65488fa8cf9","modified":1499188094806},{"_id":"public/2016/11/electron-intr/index.html","hash":"470bd239a1504716ee1ec4eabc81f6ecddd428c6","modified":1499188094806},{"_id":"public/2016/11/style/index.html","hash":"d8eb00a7029d0b1576ba70f1d9f43a4f6f208d4e","modified":1499188094806},{"_id":"public/archives/index.html","hash":"9c27499ad0140413d0203fcdbbf2a0fe775c8af5","modified":1499188094807},{"_id":"public/2016/11/hello-world/index.html","hash":"bd030800839e71961cc327f96736e5ad4df13458","modified":1499188094807},{"_id":"public/archives/2016/index.html","hash":"7d92f7e0c4ef11f2e481cfe48507652c7177bc30","modified":1499188094807},{"_id":"public/archives/2016/11/index.html","hash":"7d92f7e0c4ef11f2e481cfe48507652c7177bc30","modified":1499188094808},{"_id":"public/archives/2017/index.html","hash":"76a42b37094d1fb11fd00d79a6bcb38ec2da0cff","modified":1499188094808},{"_id":"public/archives/2017/02/index.html","hash":"78ec374d3cfd0fc48ec6ef8f40bf9a5d2e41bd84","modified":1499188094808},{"_id":"public/archives/2017/03/index.html","hash":"830ce26fa3fd24f1e0a39deb50d3841114360cba","modified":1499188094808},{"_id":"public/archives/2017/06/index.html","hash":"f8738c8fb9329a186005c3c57b43a0e8f1128584","modified":1499188094809},{"_id":"public/categories/cocos2dx/index.html","hash":"03b2a7c9396f9b5684edc2be7b03d89348bb10fe","modified":1499188094807},{"_id":"public/categories/Electron/index.html","hash":"3a4248449534d2f82dc767f883dceb899f83c82c","modified":1499188094807},{"_id":"public/categories/node-js/index.html","hash":"5e7931af7b36d52986afab1c809692ba665b47b0","modified":1499188094807},{"_id":"public/categories/Android/index.html","hash":"5ddeae3d54355d6a0a4faae7d631028bd1a25ba2","modified":1499188094807},{"_id":"public/categories/网络资源/index.html","hash":"07ea54a5f0758c25a97c3eee25e078bb8befa309","modified":1499188094807},{"_id":"public/categories/node-js/webSocket/index.html","hash":"322426a9da78add4cafa402f8914463c2dc3ef2c","modified":1499188094807},{"_id":"public/index.html","hash":"e4ef4531fc09bc0dc30d5d5cb3f81ccf847af5f7","modified":1499188094807},{"_id":"public/tags/cocos2dx-lua-debug-vscode/index.html","hash":"8f9b5b8f9cd824a85ae365103fa6b4d282808081","modified":1499188094809},{"_id":"public/tags/Electron/index.html","hash":"3a4248449534d2f82dc767f883dceb899f83c82c","modified":1499188094809},{"_id":"public/tags/nodejs/index.html","hash":"2456c620aeb12709f523fd087a57bc9b6027d409","modified":1499188094809},{"_id":"public/tags/Android/index.html","hash":"5ddeae3d54355d6a0a4faae7d631028bd1a25ba2","modified":1499188094809},{"_id":"public/tags/网络资源/index.html","hash":"07ea54a5f0758c25a97c3eee25e078bb8befa309","modified":1499188094809},{"_id":"public/tags/日记/index.html","hash":"9c85ce89bd2782b24fe3f0d3678a9d86e973b852","modified":1499188094809},{"_id":"public/tags/webSocket/index.html","hash":"322426a9da78add4cafa402f8914463c2dc3ef2c","modified":1499188094809},{"_id":"public/2016/11/websocket/index.html","hash":"51809cafded887a1cbc8660c219115133ecfd23c","modified":1499188094810},{"_id":"public/archives/2017/07/index.html","hash":"069fdd2af740c179652817a68c1fcafc24ce47ce","modified":1499188094809},{"_id":"public/tags/cocosbuilder/index.html","hash":"4f3dda6f122efeb23f204c6f130b1c43c438a306","modified":1499188094809},{"_id":"public/tags/socket-io/index.html","hash":"c45a9070991f50b8e9ff04e2fb5c27f6ced5f86b","modified":1499188094810},{"_id":"public/2017/07/compile-cocosbuilder/index.html","hash":"1211efc07f9cff1bf19ac7b6f4e904390b9d7b4e","modified":1499188094810},{"_id":"public/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1499160699337},{"_id":"public/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1499160699337},{"_id":"public/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1499160699337},{"_id":"public/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1499160699337},{"_id":"public/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1499160699337},{"_id":"public/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1499160699337},{"_id":"public/css/jquery.fancybox.css","hash":"f42f761157f26244673eb2f4a9215c70956f80dc","modified":1499160699390},{"_id":"public/js/fancybox.js","hash":"13c4781570339f4fba76a3d7f202e442817dd605","modified":1499160699390},{"_id":"public/js/codeblock-resizer.js","hash":"5d0b786d60bf225d9eabcc9cece2719ff4d9b6cd","modified":1499160699390},{"_id":"public/js/search.js","hash":"53db2eb255dd40a412ed62ea7332ca5a22f7816f","modified":1499160699390},{"_id":"public/js/share.js","hash":"f49776e0baa2b913ddc7a20db24b3edd469c8343","modified":1499160699390},{"_id":"public/js/totop.js","hash":"7dbf8fcf582a4fb6eb9b2c60d6de9f9c2091ec4c","modified":1499160699390},{"_id":"public/js/smartresize.js","hash":"3ef157fd877167e3290f42c67a624ea375a46c24","modified":1499160699390},{"_id":"public/css/style.css","hash":"ab87225d535a85b4664c0b9566622c13fa28674c","modified":1499160699391},{"_id":"source/.DS_Store","hash":"b48c4f7d61a5928be717d4bd654481ff1eab36ee","modified":1479006470000},{"_id":"themes/maupassant/.DS_Store","hash":"61d4653525ee800306d888d998f91174144e6d64","modified":1479005479000},{"_id":"themes/maupassant/layout/.DS_Store","hash":"c65c9d1aa3e98324aaca09da74ae56a88212485c","modified":1479003954000},{"_id":"themes/maupassant/source/.DS_Store","hash":"882f64897d6dc7a26bcff05bae93530f7d21fb2c","modified":1479005495000}],"Category":[{"name":"cocos2dx","_id":"cj4pdkly60002r6rlirywtrkw"},{"name":"Electron","_id":"cj4pdklyn000dr6rl4s1ikvhi"},{"name":"node.js","_id":"cj4pdklyv000or6rl64akjdri"},{"name":"Android","_id":"cj4pdklyy000sr6rle5dd3cr7"},{"name":"网络资源","_id":"cj4pdklz2000wr6rlo788fh5g"},{"name":"webSocket","parent":"cj4pdklyv000or6rl64akjdri","_id":"cj4pdklz50015r6rlu9pifzti"}],"Data":[],"Page":[],"Post":[{"title":"编译CocosBuilder 3.5 踩坑实录","date":"2017-07-04T09:13:18.000Z","_content":"\n因为cocos studio实在太过难用，简直不能愉快地码界面，所以不得已计划换到cocosbuilder下（虽然也很久没更新了，但是至少有源代码）。\n\n一个很艰难的过程就这样开始了。\n\n1.踩坑开始\n\n按照readme里的内容clone下来，初始化子模块，然后编译。毫无疑问地失败了。所以踩着前人的足迹开始踩坑。\n\n2.所以开始追随[前人的足迹](https://github.com/cocos2d/CocosBuilder/issues/434)\n\n```\ndiff --git a/.gitmodules b/.gitmodules\nindex 70efbcf..e61c729 100644\n--- a/.gitmodules\n+++ b/.gitmodules\n@@ -1,12 +1,12 @@\n [submodule \"CocosBuilder/libs/cocos2d-iphone\"]\n        path = CocosBuilder/libs/cocos2d-iphone\n-       url = https://github.com/cocos2d/cocos2d-iphone.git\n+       url = git://github.com/cocos2d/cocos2d-iphone-classic.git\n [submodule \"CocosBuilder/libs/ssziparchive\"]\n        path = CocosBuilder/libs/ssziparchive\n-       url = https://github.com/vlidholt/ssziparchive\n+       url = git://github.com/vlidholt/ssziparchive\n [submodule \"CocosBuilder/libs/Fragaria\"]\n        path = CocosBuilder/libs/Fragaria\n-       url = https://github.com/vlidholt/Fragaria.git\n+       url = git://github.com/vlidholt/Fragaria.git\n [submodule \"Examples/CocosBuilderExample/libs/CCBReader\"]\n        path = Examples/CocosBuilderExample/libs/CCBReader\n        url = git://github.com/cocos2d/CCBReader.git\n```\n\n改好之后，再编译，再次失败。\n\n于是，继续尝试。\n\n```\nOkay just worked through this.\n\nMake sure you pull branch v3.5.0.\n\nStep 1: Follow patrickhoey's Step 1 and modify .gitmodules\n\nStep 2: Make sure you're in the root directory of the CocosBuilder project and run:\ngit submodule update --init --recursive\n\nThis will error on cocos-iphone-classic.\n\nStep 3: cd CocosBuilder/libs/cocos2d-iphone\n\nStep 4: git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa\n\nStep 5: Get a copy of this project in an entirely separate directory. There have been files removed at some point that need to be re-added.\nhttps://github.com/cocos2d/cocos2d-iphone-classic\n\nStep 6: Copy the following files from the cocos2d-iphone-classic project:\ncocos-iphone-classic/cocos2d/ccFPSImages.m --> CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m\ncocos-iphone-classic/cocos2d/Support/uthash.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h\ncocos-iphone-classic/cocos2d/Support/utlist.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h\n\nThis worked for me.\n```\n按照这个描述，尝试，发现也不行。\n不过提供了一个很好的思路。\n\n于是经过多方尝试，终于找到的办法。\n\n\n1. 修改`.gitmodule`把cocos2d-iphone改成cocos2d-iphone-classic\n\n2. 进入CocosBuilder/libs/cocos2d-iphone目录，执行`git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa`\n3. 随后，按照\n\n```\nStep 6: Copy the following files from the cocos2d-iphone-classic project:\ncocos-iphone-classic/cocos2d/ccFPSImages.m --> CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m\ncocos-iphone-classic/cocos2d/Support/uthash.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h\ncocos-iphone-classic/cocos2d/Support/utlist.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h\n```\n凑齐这三个丢失的文件。\n\n###编译，通过！！！！！！！！！！！！！！\n\n\n### 运行！！\n\n\n\n\n\n\n### 崩溃！！\n\n继续寻找[前辈的足迹](https://stackoverflow.com/questions/30864055/coco2d-2-1-and-xcode-7-ios-9-crash-ccshader)。\n\n修改CCGLProgram.m，\n\n```\n#define EXTENSION_STRING \"#extension GL_OES_standard_derivatives : enable\"\nstatic NSString * g_extensionStr = @EXTENSION_STRING;\n\n- (BOOL)compileShader:(GLuint *)shader type:(GLenum)type byteArray:(const GLchar *)source\n{\n    GLint status;\n\n    if (!source)\n        return NO;\n\n    // BEGIN workaround for Xcode 7 bug\n    BOOL hasExtension = NO;\n    NSString *sourceStr = [NSString stringWithUTF8String:source];\n    if([sourceStr rangeOfString:g_extensionStr].location != NSNotFound) {\n        hasExtension = YES;\n        NSArray *strs = [sourceStr componentsSeparatedByString:g_extensionStr];\n        assert(strs.count == 2);\n        sourceStr = [strs componentsJoinedByString:@\"\\n\"];\n        source = (GLchar *)[sourceStr UTF8String];\n    }\n\n    const GLchar *sources[] = {\n        (hasExtension ? EXTENSION_STRING \"\\n\" : \"\"),\n    #ifdef __CC_PLATFORM_IOS\n        (type == GL_VERTEX_SHADER ? \"precision highp float;\\n\" : \"precision mediump float;\\n\"),\n    #endif\n        \"uniform mat4 CC_PMatrix;\\n\"\n        \"uniform mat4 CC_MVMatrix;\\n\"\n        \"uniform mat4 CC_MVPMatrix;\\n\"\n        \"uniform vec4 CC_Time;\\n\"\n        \"uniform vec4 CC_SinTime;\\n\"\n        \"uniform vec4 CC_CosTime;\\n\"\n        \"uniform vec4 CC_Random01;\\n\"\n        \"//CC INCLUDES END\\n\\n\",\n        source,\n    };\n    // END workaround for Xcode 7 bug\n```\n\n### 运行，成功！！！！！！！","source":"_posts/compile-cocosbuilder.md","raw":"---\ntitle: 编译CocosBuilder 3.5 踩坑实录\ndate: 2017-07-04 17:13:18\ntags: cocosbuilder\ncategory: cocos2dx\n---\n\n因为cocos studio实在太过难用，简直不能愉快地码界面，所以不得已计划换到cocosbuilder下（虽然也很久没更新了，但是至少有源代码）。\n\n一个很艰难的过程就这样开始了。\n\n1.踩坑开始\n\n按照readme里的内容clone下来，初始化子模块，然后编译。毫无疑问地失败了。所以踩着前人的足迹开始踩坑。\n\n2.所以开始追随[前人的足迹](https://github.com/cocos2d/CocosBuilder/issues/434)\n\n```\ndiff --git a/.gitmodules b/.gitmodules\nindex 70efbcf..e61c729 100644\n--- a/.gitmodules\n+++ b/.gitmodules\n@@ -1,12 +1,12 @@\n [submodule \"CocosBuilder/libs/cocos2d-iphone\"]\n        path = CocosBuilder/libs/cocos2d-iphone\n-       url = https://github.com/cocos2d/cocos2d-iphone.git\n+       url = git://github.com/cocos2d/cocos2d-iphone-classic.git\n [submodule \"CocosBuilder/libs/ssziparchive\"]\n        path = CocosBuilder/libs/ssziparchive\n-       url = https://github.com/vlidholt/ssziparchive\n+       url = git://github.com/vlidholt/ssziparchive\n [submodule \"CocosBuilder/libs/Fragaria\"]\n        path = CocosBuilder/libs/Fragaria\n-       url = https://github.com/vlidholt/Fragaria.git\n+       url = git://github.com/vlidholt/Fragaria.git\n [submodule \"Examples/CocosBuilderExample/libs/CCBReader\"]\n        path = Examples/CocosBuilderExample/libs/CCBReader\n        url = git://github.com/cocos2d/CCBReader.git\n```\n\n改好之后，再编译，再次失败。\n\n于是，继续尝试。\n\n```\nOkay just worked through this.\n\nMake sure you pull branch v3.5.0.\n\nStep 1: Follow patrickhoey's Step 1 and modify .gitmodules\n\nStep 2: Make sure you're in the root directory of the CocosBuilder project and run:\ngit submodule update --init --recursive\n\nThis will error on cocos-iphone-classic.\n\nStep 3: cd CocosBuilder/libs/cocos2d-iphone\n\nStep 4: git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa\n\nStep 5: Get a copy of this project in an entirely separate directory. There have been files removed at some point that need to be re-added.\nhttps://github.com/cocos2d/cocos2d-iphone-classic\n\nStep 6: Copy the following files from the cocos2d-iphone-classic project:\ncocos-iphone-classic/cocos2d/ccFPSImages.m --> CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m\ncocos-iphone-classic/cocos2d/Support/uthash.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h\ncocos-iphone-classic/cocos2d/Support/utlist.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h\n\nThis worked for me.\n```\n按照这个描述，尝试，发现也不行。\n不过提供了一个很好的思路。\n\n于是经过多方尝试，终于找到的办法。\n\n\n1. 修改`.gitmodule`把cocos2d-iphone改成cocos2d-iphone-classic\n\n2. 进入CocosBuilder/libs/cocos2d-iphone目录，执行`git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa`\n3. 随后，按照\n\n```\nStep 6: Copy the following files from the cocos2d-iphone-classic project:\ncocos-iphone-classic/cocos2d/ccFPSImages.m --> CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m\ncocos-iphone-classic/cocos2d/Support/uthash.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h\ncocos-iphone-classic/cocos2d/Support/utlist.h --> CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h\n```\n凑齐这三个丢失的文件。\n\n###编译，通过！！！！！！！！！！！！！！\n\n\n### 运行！！\n\n\n\n\n\n\n### 崩溃！！\n\n继续寻找[前辈的足迹](https://stackoverflow.com/questions/30864055/coco2d-2-1-and-xcode-7-ios-9-crash-ccshader)。\n\n修改CCGLProgram.m，\n\n```\n#define EXTENSION_STRING \"#extension GL_OES_standard_derivatives : enable\"\nstatic NSString * g_extensionStr = @EXTENSION_STRING;\n\n- (BOOL)compileShader:(GLuint *)shader type:(GLenum)type byteArray:(const GLchar *)source\n{\n    GLint status;\n\n    if (!source)\n        return NO;\n\n    // BEGIN workaround for Xcode 7 bug\n    BOOL hasExtension = NO;\n    NSString *sourceStr = [NSString stringWithUTF8String:source];\n    if([sourceStr rangeOfString:g_extensionStr].location != NSNotFound) {\n        hasExtension = YES;\n        NSArray *strs = [sourceStr componentsSeparatedByString:g_extensionStr];\n        assert(strs.count == 2);\n        sourceStr = [strs componentsJoinedByString:@\"\\n\"];\n        source = (GLchar *)[sourceStr UTF8String];\n    }\n\n    const GLchar *sources[] = {\n        (hasExtension ? EXTENSION_STRING \"\\n\" : \"\"),\n    #ifdef __CC_PLATFORM_IOS\n        (type == GL_VERTEX_SHADER ? \"precision highp float;\\n\" : \"precision mediump float;\\n\"),\n    #endif\n        \"uniform mat4 CC_PMatrix;\\n\"\n        \"uniform mat4 CC_MVMatrix;\\n\"\n        \"uniform mat4 CC_MVPMatrix;\\n\"\n        \"uniform vec4 CC_Time;\\n\"\n        \"uniform vec4 CC_SinTime;\\n\"\n        \"uniform vec4 CC_CosTime;\\n\"\n        \"uniform vec4 CC_Random01;\\n\"\n        \"//CC INCLUDES END\\n\\n\",\n        source,\n    };\n    // END workaround for Xcode 7 bug\n```\n\n### 运行，成功！！！！！！！","slug":"compile-cocosbuilder","published":1,"updated":"2017-07-04T09:31:08.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdkly00000r6rlzm1hrnqs","content":"<p>因为cocos studio实在太过难用，简直不能愉快地码界面，所以不得已计划换到cocosbuilder下（虽然也很久没更新了，但是至少有源代码）。</p>\n<p>一个很艰难的过程就这样开始了。</p>\n<p>1.踩坑开始</p>\n<p>按照readme里的内容clone下来，初始化子模块，然后编译。毫无疑问地失败了。所以踩着前人的足迹开始踩坑。</p>\n<p>2.所以开始追随<a href=\"https://github.com/cocos2d/CocosBuilder/issues/434\">前人的足迹</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">diff --git a/.gitmodules b/.gitmodules</div><div class=\"line\">index 70efbcf..e61c729 100644</div><div class=\"line\">--- a/.gitmodules</div><div class=\"line\">+++ b/.gitmodules</div><div class=\"line\">@@ -1,12 +1,12 @@</div><div class=\"line\"> [submodule &quot;CocosBuilder/libs/cocos2d-iphone&quot;]</div><div class=\"line\">        path = CocosBuilder/libs/cocos2d-iphone</div><div class=\"line\">-       url = https://github.com/cocos2d/cocos2d-iphone.git</div><div class=\"line\">+       url = git://github.com/cocos2d/cocos2d-iphone-classic.git</div><div class=\"line\"> [submodule &quot;CocosBuilder/libs/ssziparchive&quot;]</div><div class=\"line\">        path = CocosBuilder/libs/ssziparchive</div><div class=\"line\">-       url = https://github.com/vlidholt/ssziparchive</div><div class=\"line\">+       url = git://github.com/vlidholt/ssziparchive</div><div class=\"line\"> [submodule &quot;CocosBuilder/libs/Fragaria&quot;]</div><div class=\"line\">        path = CocosBuilder/libs/Fragaria</div><div class=\"line\">-       url = https://github.com/vlidholt/Fragaria.git</div><div class=\"line\">+       url = git://github.com/vlidholt/Fragaria.git</div><div class=\"line\"> [submodule &quot;Examples/CocosBuilderExample/libs/CCBReader&quot;]</div><div class=\"line\">        path = Examples/CocosBuilderExample/libs/CCBReader</div><div class=\"line\">        url = git://github.com/cocos2d/CCBReader.git</div></pre></td></tr></table></figure>\n<p>改好之后，再编译，再次失败。</p>\n<p>于是，继续尝试。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">Okay just worked through this.</div><div class=\"line\"></div><div class=\"line\">Make sure you pull branch v3.5.0.</div><div class=\"line\"></div><div class=\"line\">Step 1: Follow patrickhoey&apos;s Step 1 and modify .gitmodules</div><div class=\"line\"></div><div class=\"line\">Step 2: Make sure you&apos;re in the root directory of the CocosBuilder project and run:</div><div class=\"line\">git submodule update --init --recursive</div><div class=\"line\"></div><div class=\"line\">This will error on cocos-iphone-classic.</div><div class=\"line\"></div><div class=\"line\">Step 3: cd CocosBuilder/libs/cocos2d-iphone</div><div class=\"line\"></div><div class=\"line\">Step 4: git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa</div><div class=\"line\"></div><div class=\"line\">Step 5: Get a copy of this project in an entirely separate directory. There have been files removed at some point that need to be re-added.</div><div class=\"line\">https://github.com/cocos2d/cocos2d-iphone-classic</div><div class=\"line\"></div><div class=\"line\">Step 6: Copy the following files from the cocos2d-iphone-classic project:</div><div class=\"line\">cocos-iphone-classic/cocos2d/ccFPSImages.m --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/uthash.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/utlist.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h</div><div class=\"line\"></div><div class=\"line\">This worked for me.</div></pre></td></tr></table></figure>\n<p>按照这个描述，尝试，发现也不行。<br>不过提供了一个很好的思路。</p>\n<p>于是经过多方尝试，终于找到的办法。</p>\n<ol>\n<li><p>修改<code>.gitmodule</code>把cocos2d-iphone改成cocos2d-iphone-classic</p>\n</li>\n<li><p>进入CocosBuilder/libs/cocos2d-iphone目录，执行<code>git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa</code></p>\n</li>\n<li>随后，按照</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Step 6: Copy the following files from the cocos2d-iphone-classic project:</div><div class=\"line\">cocos-iphone-classic/cocos2d/ccFPSImages.m --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/uthash.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/utlist.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h</div></pre></td></tr></table></figure>\n<p>凑齐这三个丢失的文件。</p>\n<p>###编译，通过！！！！！！！！！！！！！！</p>\n<h3 id=\"运行！！\"><a href=\"#运行！！\" class=\"headerlink\" title=\"运行！！\"></a>运行！！</h3><h3 id=\"崩溃！！\"><a href=\"#崩溃！！\" class=\"headerlink\" title=\"崩溃！！\"></a>崩溃！！</h3><p>继续寻找<a href=\"https://stackoverflow.com/questions/30864055/coco2d-2-1-and-xcode-7-ios-9-crash-ccshader\">前辈的足迹</a>。</p>\n<p>修改CCGLProgram.m，</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">#define EXTENSION_STRING &quot;#extension GL_OES_standard_derivatives : enable&quot;</div><div class=\"line\">static NSString * g_extensionStr = @EXTENSION_STRING;</div><div class=\"line\"></div><div class=\"line\">- (BOOL)compileShader:(GLuint *)shader type:(GLenum)type byteArray:(const GLchar *)source</div><div class=\"line\">&#123;</div><div class=\"line\">    GLint status;</div><div class=\"line\"></div><div class=\"line\">    if (!source)</div><div class=\"line\">        return NO;</div><div class=\"line\"></div><div class=\"line\">    // BEGIN workaround for Xcode 7 bug</div><div class=\"line\">    BOOL hasExtension = NO;</div><div class=\"line\">    NSString *sourceStr = [NSString stringWithUTF8String:source];</div><div class=\"line\">    if([sourceStr rangeOfString:g_extensionStr].location != NSNotFound) &#123;</div><div class=\"line\">        hasExtension = YES;</div><div class=\"line\">        NSArray *strs = [sourceStr componentsSeparatedByString:g_extensionStr];</div><div class=\"line\">        assert(strs.count == 2);</div><div class=\"line\">        sourceStr = [strs componentsJoinedByString:@&quot;\\n&quot;];</div><div class=\"line\">        source = (GLchar *)[sourceStr UTF8String];</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    const GLchar *sources[] = &#123;</div><div class=\"line\">        (hasExtension ? EXTENSION_STRING &quot;\\n&quot; : &quot;&quot;),</div><div class=\"line\">    #ifdef __CC_PLATFORM_IOS</div><div class=\"line\">        (type == GL_VERTEX_SHADER ? &quot;precision highp float;\\n&quot; : &quot;precision mediump float;\\n&quot;),</div><div class=\"line\">    #endif</div><div class=\"line\">        &quot;uniform mat4 CC_PMatrix;\\n&quot;</div><div class=\"line\">        &quot;uniform mat4 CC_MVMatrix;\\n&quot;</div><div class=\"line\">        &quot;uniform mat4 CC_MVPMatrix;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_Time;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_SinTime;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_CosTime;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_Random01;\\n&quot;</div><div class=\"line\">        &quot;//CC INCLUDES END\\n\\n&quot;,</div><div class=\"line\">        source,</div><div class=\"line\">    &#125;;</div><div class=\"line\">    // END workaround for Xcode 7 bug</div></pre></td></tr></table></figure>\n<h3 id=\"运行，成功！！！！！！！\"><a href=\"#运行，成功！！！！！！！\" class=\"headerlink\" title=\"运行，成功！！！！！！！\"></a>运行，成功！！！！！！！</h3>","excerpt":"","more":"<p>因为cocos studio实在太过难用，简直不能愉快地码界面，所以不得已计划换到cocosbuilder下（虽然也很久没更新了，但是至少有源代码）。</p>\n<p>一个很艰难的过程就这样开始了。</p>\n<p>1.踩坑开始</p>\n<p>按照readme里的内容clone下来，初始化子模块，然后编译。毫无疑问地失败了。所以踩着前人的足迹开始踩坑。</p>\n<p>2.所以开始追随<a href=\"https://github.com/cocos2d/CocosBuilder/issues/434\">前人的足迹</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">diff --git a/.gitmodules b/.gitmodules</div><div class=\"line\">index 70efbcf..e61c729 100644</div><div class=\"line\">--- a/.gitmodules</div><div class=\"line\">+++ b/.gitmodules</div><div class=\"line\">@@ -1,12 +1,12 @@</div><div class=\"line\"> [submodule &quot;CocosBuilder/libs/cocos2d-iphone&quot;]</div><div class=\"line\">        path = CocosBuilder/libs/cocos2d-iphone</div><div class=\"line\">-       url = https://github.com/cocos2d/cocos2d-iphone.git</div><div class=\"line\">+       url = git://github.com/cocos2d/cocos2d-iphone-classic.git</div><div class=\"line\"> [submodule &quot;CocosBuilder/libs/ssziparchive&quot;]</div><div class=\"line\">        path = CocosBuilder/libs/ssziparchive</div><div class=\"line\">-       url = https://github.com/vlidholt/ssziparchive</div><div class=\"line\">+       url = git://github.com/vlidholt/ssziparchive</div><div class=\"line\"> [submodule &quot;CocosBuilder/libs/Fragaria&quot;]</div><div class=\"line\">        path = CocosBuilder/libs/Fragaria</div><div class=\"line\">-       url = https://github.com/vlidholt/Fragaria.git</div><div class=\"line\">+       url = git://github.com/vlidholt/Fragaria.git</div><div class=\"line\"> [submodule &quot;Examples/CocosBuilderExample/libs/CCBReader&quot;]</div><div class=\"line\">        path = Examples/CocosBuilderExample/libs/CCBReader</div><div class=\"line\">        url = git://github.com/cocos2d/CCBReader.git</div></pre></td></tr></table></figure>\n<p>改好之后，再编译，再次失败。</p>\n<p>于是，继续尝试。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div></pre></td><td class=\"code\"><pre><div class=\"line\">Okay just worked through this.</div><div class=\"line\"></div><div class=\"line\">Make sure you pull branch v3.5.0.</div><div class=\"line\"></div><div class=\"line\">Step 1: Follow patrickhoey&apos;s Step 1 and modify .gitmodules</div><div class=\"line\"></div><div class=\"line\">Step 2: Make sure you&apos;re in the root directory of the CocosBuilder project and run:</div><div class=\"line\">git submodule update --init --recursive</div><div class=\"line\"></div><div class=\"line\">This will error on cocos-iphone-classic.</div><div class=\"line\"></div><div class=\"line\">Step 3: cd CocosBuilder/libs/cocos2d-iphone</div><div class=\"line\"></div><div class=\"line\">Step 4: git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa</div><div class=\"line\"></div><div class=\"line\">Step 5: Get a copy of this project in an entirely separate directory. There have been files removed at some point that need to be re-added.</div><div class=\"line\">https://github.com/cocos2d/cocos2d-iphone-classic</div><div class=\"line\"></div><div class=\"line\">Step 6: Copy the following files from the cocos2d-iphone-classic project:</div><div class=\"line\">cocos-iphone-classic/cocos2d/ccFPSImages.m --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/uthash.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/utlist.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h</div><div class=\"line\"></div><div class=\"line\">This worked for me.</div></pre></td></tr></table></figure>\n<p>按照这个描述，尝试，发现也不行。<br>不过提供了一个很好的思路。</p>\n<p>于是经过多方尝试，终于找到的办法。</p>\n<ol>\n<li><p>修改<code>.gitmodule</code>把cocos2d-iphone改成cocos2d-iphone-classic</p>\n</li>\n<li><p>进入CocosBuilder/libs/cocos2d-iphone目录，执行<code>git checkout 5e8fdee5cdc4450ad32f5a8579ee6a0fdcbb1cfa</code></p>\n</li>\n<li>随后，按照</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Step 6: Copy the following files from the cocos2d-iphone-classic project:</div><div class=\"line\">cocos-iphone-classic/cocos2d/ccFPSImages.m --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/ccFPSImages.m</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/uthash.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/uthash.h</div><div class=\"line\">cocos-iphone-classic/cocos2d/Support/utlist.h --&gt; CocosBuilder/libs/cocos2d-iphone/cocos2d/Support/utlist.h</div></pre></td></tr></table></figure>\n<p>凑齐这三个丢失的文件。</p>\n<p>###编译，通过！！！！！！！！！！！！！！</p>\n<h3 id=\"运行！！\"><a href=\"#运行！！\" class=\"headerlink\" title=\"运行！！\"></a>运行！！</h3><h3 id=\"崩溃！！\"><a href=\"#崩溃！！\" class=\"headerlink\" title=\"崩溃！！\"></a>崩溃！！</h3><p>继续寻找<a href=\"https://stackoverflow.com/questions/30864055/coco2d-2-1-and-xcode-7-ios-9-crash-ccshader\">前辈的足迹</a>。</p>\n<p>修改CCGLProgram.m，</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">#define EXTENSION_STRING &quot;#extension GL_OES_standard_derivatives : enable&quot;</div><div class=\"line\">static NSString * g_extensionStr = @EXTENSION_STRING;</div><div class=\"line\"></div><div class=\"line\">- (BOOL)compileShader:(GLuint *)shader type:(GLenum)type byteArray:(const GLchar *)source</div><div class=\"line\">&#123;</div><div class=\"line\">    GLint status;</div><div class=\"line\"></div><div class=\"line\">    if (!source)</div><div class=\"line\">        return NO;</div><div class=\"line\"></div><div class=\"line\">    // BEGIN workaround for Xcode 7 bug</div><div class=\"line\">    BOOL hasExtension = NO;</div><div class=\"line\">    NSString *sourceStr = [NSString stringWithUTF8String:source];</div><div class=\"line\">    if([sourceStr rangeOfString:g_extensionStr].location != NSNotFound) &#123;</div><div class=\"line\">        hasExtension = YES;</div><div class=\"line\">        NSArray *strs = [sourceStr componentsSeparatedByString:g_extensionStr];</div><div class=\"line\">        assert(strs.count == 2);</div><div class=\"line\">        sourceStr = [strs componentsJoinedByString:@&quot;\\n&quot;];</div><div class=\"line\">        source = (GLchar *)[sourceStr UTF8String];</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    const GLchar *sources[] = &#123;</div><div class=\"line\">        (hasExtension ? EXTENSION_STRING &quot;\\n&quot; : &quot;&quot;),</div><div class=\"line\">    #ifdef __CC_PLATFORM_IOS</div><div class=\"line\">        (type == GL_VERTEX_SHADER ? &quot;precision highp float;\\n&quot; : &quot;precision mediump float;\\n&quot;),</div><div class=\"line\">    #endif</div><div class=\"line\">        &quot;uniform mat4 CC_PMatrix;\\n&quot;</div><div class=\"line\">        &quot;uniform mat4 CC_MVMatrix;\\n&quot;</div><div class=\"line\">        &quot;uniform mat4 CC_MVPMatrix;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_Time;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_SinTime;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_CosTime;\\n&quot;</div><div class=\"line\">        &quot;uniform vec4 CC_Random01;\\n&quot;</div><div class=\"line\">        &quot;//CC INCLUDES END\\n\\n&quot;,</div><div class=\"line\">        source,</div><div class=\"line\">    &#125;;</div><div class=\"line\">    // END workaround for Xcode 7 bug</div></pre></td></tr></table></figure>\n<h3 id=\"运行，成功！！！！！！！\"><a href=\"#运行，成功！！！！！！！\" class=\"headerlink\" title=\"运行，成功！！！！！！！\"></a>运行，成功！！！！！！！</h3>"},{"title":"在cocos2dx-lua中调试lua代码","date":"2017-03-08T03:09:29.000Z","_content":"\n\n\nlua是游戏开发中常用的脚本语言。本文主要讲述如何在vscode中搭建针对cocos2dx-lua的debug环境，以实现断点和单步调试。\n\n## 基础环境\n\n首先所需的基础环境包括:\nvscode \nnode.js\ncocos2dx-lua(我使用的是3.14.1版本，其他版本尚未测试,理论上2.x版本也可用)\n\n\n## lua调试环境搭建\n\n#### Step 1: 安装vscode扩展插件 `lua Debugger` \n\n![图1](/img/cocos_lua_debug/lua_0.png)\n\n之后按照配置说明，下载`vscode-debuggee.lua`并且复制到cocos2dx-lua的src目录下（目录随意，只要require的时候能够require到就可以），这里需要注意一下引入debuggee的代码，第一行的`local json = require 'dkjson'`不是必须的，这里只需要提供一个，包含 encode和decode方法的json包即可，可以用cjson也可以用cocos2dx-lua自带的json.lua，这个json工具是用来解析和发送调试指令的。\n\n\n#### Step 2: 配置Debug插件\n\n在debug面板增加调试配置，选择`Lua Debugger`，如图\n![](/img/cocos_lua_debug/lua_1.png)\n\n之后会打开配置选项\n![](/img/cocos_lua_debug/lua_2.png)\n我们用到的设置，只有最后一个`wait`的配置。这里需要重点关注`sourceBasePath`用来设置代码的根目录，当断点触发时，调试器会根据相对路径拼接上这个基础路径，来查找对应的lua代码，如果不设置正确，那么调试的时候将找不到对应的lua代码，导致调试器报错。\n\n#### Step 3: 引入调试插件\n\n设置好后，我们去修改cocos2dx-lua的代码，\n![](/img/cocos_lua_debug/lua_3.png)\n\n打开cocos2dx-lua的默认入口lua文件`controller.lua`，在这个文件的合适位置（合适位置的意思是，保证json是可用的，如果引入其他的json库，则不必将代码放在上图所示位置)加入启动调试器的代码。如果不是本机调试，还需要设置IP地址和相应的端口号。具体请参考`Lua Debugger`的配置帮助。\n\n#### Step 4： 开启调试之旅\n\n最后，随便找个文件，打一个断点（文中断点位置为AccelerometerTest.lua），然后启动调试器，会有下图所示提示。\n\n\n![](/img/cocos_lua_debug/lua_4.png)\n\n\n最后打开你的vs/xcode/android/ios 工程，运行（我这里是在windows下用vs运行了win32项目工程),启动后，等待连接界面消失，表示调试器已经成功连接。\n然后触发断点，断点成功，如图所示：\n\n![](/img/cocos_lua_debug/lua_5.png)\n\n左侧可以看到变量内容，右侧鼠标指向相应的变量，可以看到具体的变量信息。可以单步逐行执行代码。\n\n至此，cocos2dx-lua的调试环境搭建完成。\n\n\n\n\n## 写在最后\n\nvscode还是十分强大的，cocos2dx-js的调试环境搭建相对更加简单一些,后续会整理一篇搭建cocos2dx-js调试环境的文章。\n\n\n\n\n\n\n\n","source":"_posts/cocos-lua-debug.md","raw":"---\ntitle: 在cocos2dx-lua中调试lua代码\ndate: 2017-03-08 11:09:29\ntags: cocos2dx lua debug vscode\ncategory: cocos2dx\n---\n\n\n\nlua是游戏开发中常用的脚本语言。本文主要讲述如何在vscode中搭建针对cocos2dx-lua的debug环境，以实现断点和单步调试。\n\n## 基础环境\n\n首先所需的基础环境包括:\nvscode \nnode.js\ncocos2dx-lua(我使用的是3.14.1版本，其他版本尚未测试,理论上2.x版本也可用)\n\n\n## lua调试环境搭建\n\n#### Step 1: 安装vscode扩展插件 `lua Debugger` \n\n![图1](/img/cocos_lua_debug/lua_0.png)\n\n之后按照配置说明，下载`vscode-debuggee.lua`并且复制到cocos2dx-lua的src目录下（目录随意，只要require的时候能够require到就可以），这里需要注意一下引入debuggee的代码，第一行的`local json = require 'dkjson'`不是必须的，这里只需要提供一个，包含 encode和decode方法的json包即可，可以用cjson也可以用cocos2dx-lua自带的json.lua，这个json工具是用来解析和发送调试指令的。\n\n\n#### Step 2: 配置Debug插件\n\n在debug面板增加调试配置，选择`Lua Debugger`，如图\n![](/img/cocos_lua_debug/lua_1.png)\n\n之后会打开配置选项\n![](/img/cocos_lua_debug/lua_2.png)\n我们用到的设置，只有最后一个`wait`的配置。这里需要重点关注`sourceBasePath`用来设置代码的根目录，当断点触发时，调试器会根据相对路径拼接上这个基础路径，来查找对应的lua代码，如果不设置正确，那么调试的时候将找不到对应的lua代码，导致调试器报错。\n\n#### Step 3: 引入调试插件\n\n设置好后，我们去修改cocos2dx-lua的代码，\n![](/img/cocos_lua_debug/lua_3.png)\n\n打开cocos2dx-lua的默认入口lua文件`controller.lua`，在这个文件的合适位置（合适位置的意思是，保证json是可用的，如果引入其他的json库，则不必将代码放在上图所示位置)加入启动调试器的代码。如果不是本机调试，还需要设置IP地址和相应的端口号。具体请参考`Lua Debugger`的配置帮助。\n\n#### Step 4： 开启调试之旅\n\n最后，随便找个文件，打一个断点（文中断点位置为AccelerometerTest.lua），然后启动调试器，会有下图所示提示。\n\n\n![](/img/cocos_lua_debug/lua_4.png)\n\n\n最后打开你的vs/xcode/android/ios 工程，运行（我这里是在windows下用vs运行了win32项目工程),启动后，等待连接界面消失，表示调试器已经成功连接。\n然后触发断点，断点成功，如图所示：\n\n![](/img/cocos_lua_debug/lua_5.png)\n\n左侧可以看到变量内容，右侧鼠标指向相应的变量，可以看到具体的变量信息。可以单步逐行执行代码。\n\n至此，cocos2dx-lua的调试环境搭建完成。\n\n\n\n\n## 写在最后\n\nvscode还是十分强大的，cocos2dx-js的调试环境搭建相对更加简单一些,后续会整理一篇搭建cocos2dx-js调试环境的文章。\n\n\n\n\n\n\n\n","slug":"cocos-lua-debug","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdkly40001r6rl38xvq73l","content":"<p>lua是游戏开发中常用的脚本语言。本文主要讲述如何在vscode中搭建针对cocos2dx-lua的debug环境，以实现断点和单步调试。</p>\n<h2 id=\"基础环境\"><a href=\"#基础环境\" class=\"headerlink\" title=\"基础环境\"></a>基础环境</h2><p>首先所需的基础环境包括:<br>vscode<br>node.js<br>cocos2dx-lua(我使用的是3.14.1版本，其他版本尚未测试,理论上2.x版本也可用)</p>\n<h2 id=\"lua调试环境搭建\"><a href=\"#lua调试环境搭建\" class=\"headerlink\" title=\"lua调试环境搭建\"></a>lua调试环境搭建</h2><h4 id=\"Step-1-安装vscode扩展插件-lua-Debugger\"><a href=\"#Step-1-安装vscode扩展插件-lua-Debugger\" class=\"headerlink\" title=\"Step 1: 安装vscode扩展插件 lua Debugger\"></a>Step 1: 安装vscode扩展插件 <code>lua Debugger</code></h4><p><img src=\"/img/cocos_lua_debug/lua_0.png\" alt=\"图1\"></p>\n<p>之后按照配置说明，下载<code>vscode-debuggee.lua</code>并且复制到cocos2dx-lua的src目录下（目录随意，只要require的时候能够require到就可以），这里需要注意一下引入debuggee的代码，第一行的<code>local json = require &#39;dkjson&#39;</code>不是必须的，这里只需要提供一个，包含 encode和decode方法的json包即可，可以用cjson也可以用cocos2dx-lua自带的json.lua，这个json工具是用来解析和发送调试指令的。</p>\n<h4 id=\"Step-2-配置Debug插件\"><a href=\"#Step-2-配置Debug插件\" class=\"headerlink\" title=\"Step 2: 配置Debug插件\"></a>Step 2: 配置Debug插件</h4><p>在debug面板增加调试配置，选择<code>Lua Debugger</code>，如图<br><img src=\"/img/cocos_lua_debug/lua_1.png\" alt=\"\"></p>\n<p>之后会打开配置选项<br><img src=\"/img/cocos_lua_debug/lua_2.png\" alt=\"\"><br>我们用到的设置，只有最后一个<code>wait</code>的配置。这里需要重点关注<code>sourceBasePath</code>用来设置代码的根目录，当断点触发时，调试器会根据相对路径拼接上这个基础路径，来查找对应的lua代码，如果不设置正确，那么调试的时候将找不到对应的lua代码，导致调试器报错。</p>\n<h4 id=\"Step-3-引入调试插件\"><a href=\"#Step-3-引入调试插件\" class=\"headerlink\" title=\"Step 3: 引入调试插件\"></a>Step 3: 引入调试插件</h4><p>设置好后，我们去修改cocos2dx-lua的代码，<br><img src=\"/img/cocos_lua_debug/lua_3.png\" alt=\"\"></p>\n<p>打开cocos2dx-lua的默认入口lua文件<code>controller.lua</code>，在这个文件的合适位置（合适位置的意思是，保证json是可用的，如果引入其他的json库，则不必将代码放在上图所示位置)加入启动调试器的代码。如果不是本机调试，还需要设置IP地址和相应的端口号。具体请参考<code>Lua Debugger</code>的配置帮助。</p>\n<h4 id=\"Step-4：-开启调试之旅\"><a href=\"#Step-4：-开启调试之旅\" class=\"headerlink\" title=\"Step 4： 开启调试之旅\"></a>Step 4： 开启调试之旅</h4><p>最后，随便找个文件，打一个断点（文中断点位置为AccelerometerTest.lua），然后启动调试器，会有下图所示提示。</p>\n<p><img src=\"/img/cocos_lua_debug/lua_4.png\" alt=\"\"></p>\n<p>最后打开你的vs/xcode/android/ios 工程，运行（我这里是在windows下用vs运行了win32项目工程),启动后，等待连接界面消失，表示调试器已经成功连接。<br>然后触发断点，断点成功，如图所示：</p>\n<p><img src=\"/img/cocos_lua_debug/lua_5.png\" alt=\"\"></p>\n<p>左侧可以看到变量内容，右侧鼠标指向相应的变量，可以看到具体的变量信息。可以单步逐行执行代码。</p>\n<p>至此，cocos2dx-lua的调试环境搭建完成。</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>vscode还是十分强大的，cocos2dx-js的调试环境搭建相对更加简单一些,后续会整理一篇搭建cocos2dx-js调试环境的文章。</p>\n","excerpt":"","more":"<p>lua是游戏开发中常用的脚本语言。本文主要讲述如何在vscode中搭建针对cocos2dx-lua的debug环境，以实现断点和单步调试。</p>\n<h2 id=\"基础环境\"><a href=\"#基础环境\" class=\"headerlink\" title=\"基础环境\"></a>基础环境</h2><p>首先所需的基础环境包括:<br>vscode<br>node.js<br>cocos2dx-lua(我使用的是3.14.1版本，其他版本尚未测试,理论上2.x版本也可用)</p>\n<h2 id=\"lua调试环境搭建\"><a href=\"#lua调试环境搭建\" class=\"headerlink\" title=\"lua调试环境搭建\"></a>lua调试环境搭建</h2><h4 id=\"Step-1-安装vscode扩展插件-lua-Debugger\"><a href=\"#Step-1-安装vscode扩展插件-lua-Debugger\" class=\"headerlink\" title=\"Step 1: 安装vscode扩展插件 lua Debugger\"></a>Step 1: 安装vscode扩展插件 <code>lua Debugger</code></h4><p><img src=\"/img/cocos_lua_debug/lua_0.png\" alt=\"图1\"></p>\n<p>之后按照配置说明，下载<code>vscode-debuggee.lua</code>并且复制到cocos2dx-lua的src目录下（目录随意，只要require的时候能够require到就可以），这里需要注意一下引入debuggee的代码，第一行的<code>local json = require &#39;dkjson&#39;</code>不是必须的，这里只需要提供一个，包含 encode和decode方法的json包即可，可以用cjson也可以用cocos2dx-lua自带的json.lua，这个json工具是用来解析和发送调试指令的。</p>\n<h4 id=\"Step-2-配置Debug插件\"><a href=\"#Step-2-配置Debug插件\" class=\"headerlink\" title=\"Step 2: 配置Debug插件\"></a>Step 2: 配置Debug插件</h4><p>在debug面板增加调试配置，选择<code>Lua Debugger</code>，如图<br><img src=\"/img/cocos_lua_debug/lua_1.png\" alt=\"\"></p>\n<p>之后会打开配置选项<br><img src=\"/img/cocos_lua_debug/lua_2.png\" alt=\"\"><br>我们用到的设置，只有最后一个<code>wait</code>的配置。这里需要重点关注<code>sourceBasePath</code>用来设置代码的根目录，当断点触发时，调试器会根据相对路径拼接上这个基础路径，来查找对应的lua代码，如果不设置正确，那么调试的时候将找不到对应的lua代码，导致调试器报错。</p>\n<h4 id=\"Step-3-引入调试插件\"><a href=\"#Step-3-引入调试插件\" class=\"headerlink\" title=\"Step 3: 引入调试插件\"></a>Step 3: 引入调试插件</h4><p>设置好后，我们去修改cocos2dx-lua的代码，<br><img src=\"/img/cocos_lua_debug/lua_3.png\" alt=\"\"></p>\n<p>打开cocos2dx-lua的默认入口lua文件<code>controller.lua</code>，在这个文件的合适位置（合适位置的意思是，保证json是可用的，如果引入其他的json库，则不必将代码放在上图所示位置)加入启动调试器的代码。如果不是本机调试，还需要设置IP地址和相应的端口号。具体请参考<code>Lua Debugger</code>的配置帮助。</p>\n<h4 id=\"Step-4：-开启调试之旅\"><a href=\"#Step-4：-开启调试之旅\" class=\"headerlink\" title=\"Step 4： 开启调试之旅\"></a>Step 4： 开启调试之旅</h4><p>最后，随便找个文件，打一个断点（文中断点位置为AccelerometerTest.lua），然后启动调试器，会有下图所示提示。</p>\n<p><img src=\"/img/cocos_lua_debug/lua_4.png\" alt=\"\"></p>\n<p>最后打开你的vs/xcode/android/ios 工程，运行（我这里是在windows下用vs运行了win32项目工程),启动后，等待连接界面消失，表示调试器已经成功连接。<br>然后触发断点，断点成功，如图所示：</p>\n<p><img src=\"/img/cocos_lua_debug/lua_5.png\" alt=\"\"></p>\n<p>左侧可以看到变量内容，右侧鼠标指向相应的变量，可以看到具体的变量信息。可以单步逐行执行代码。</p>\n<p>至此，cocos2dx-lua的调试环境搭建完成。</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>vscode还是十分强大的，cocos2dx-js的调试环境搭建相对更加简单一些,后续会整理一篇搭建cocos2dx-js调试环境的文章。</p>\n"},{"title":"Electron 简介","date":"2016-11-12T04:10:20.000Z","_content":"\n[Electron](http://electron.atom.io/)是一个基于node.js的跨平台桌面应用组件（暂且称之为组件，对node.js只是初学，不知道标准的称呼是什么）。\n\n它最大的有点在于可以使用JavaScript 和 HTML来构建跨平台的桌面应用。\n\n我们常见的文本编辑器 atom，vscode和知名的游戏引擎cocos2dx推出的游戏编辑器cocos creator就是基于[Electron](http://electron.atom.io/)开发的。\n\n这直接降低了桌面应用开发的难度，并且兼容许多js版本的功能，尤其对于游戏开发，十分友好。\n\n由于近期工具开发的需要，接触了node.js开发，后续会有相关的学习笔记，来整理学习的过程。","source":"_posts/electron-intr.md","raw":"---\ntitle:  Electron 简介\ndate: 2016-11-12 12:10:20\ntags: Electron\ncategory: Electron\n---\n\n[Electron](http://electron.atom.io/)是一个基于node.js的跨平台桌面应用组件（暂且称之为组件，对node.js只是初学，不知道标准的称呼是什么）。\n\n它最大的有点在于可以使用JavaScript 和 HTML来构建跨平台的桌面应用。\n\n我们常见的文本编辑器 atom，vscode和知名的游戏引擎cocos2dx推出的游戏编辑器cocos creator就是基于[Electron](http://electron.atom.io/)开发的。\n\n这直接降低了桌面应用开发的难度，并且兼容许多js版本的功能，尤其对于游戏开发，十分友好。\n\n由于近期工具开发的需要，接触了node.js开发，后续会有相关的学习笔记，来整理学习的过程。","slug":"electron-intr","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklya0004r6rl120ehjg6","content":"<p><a href=\"http://electron.atom.io/\">Electron</a>是一个基于node.js的跨平台桌面应用组件（暂且称之为组件，对node.js只是初学，不知道标准的称呼是什么）。</p>\n<p>它最大的有点在于可以使用JavaScript 和 HTML来构建跨平台的桌面应用。</p>\n<p>我们常见的文本编辑器 atom，vscode和知名的游戏引擎cocos2dx推出的游戏编辑器cocos creator就是基于<a href=\"http://electron.atom.io/\">Electron</a>开发的。</p>\n<p>这直接降低了桌面应用开发的难度，并且兼容许多js版本的功能，尤其对于游戏开发，十分友好。</p>\n<p>由于近期工具开发的需要，接触了node.js开发，后续会有相关的学习笔记，来整理学习的过程。</p>\n","excerpt":"","more":"<p><a href=\"http://electron.atom.io/\">Electron</a>是一个基于node.js的跨平台桌面应用组件（暂且称之为组件，对node.js只是初学，不知道标准的称呼是什么）。</p>\n<p>它最大的有点在于可以使用JavaScript 和 HTML来构建跨平台的桌面应用。</p>\n<p>我们常见的文本编辑器 atom，vscode和知名的游戏引擎cocos2dx推出的游戏编辑器cocos creator就是基于<a href=\"http://electron.atom.io/\">Electron</a>开发的。</p>\n<p>这直接降低了桌面应用开发的难度，并且兼容许多js版本的功能，尤其对于游戏开发，十分友好。</p>\n<p>由于近期工具开发的需要，接触了node.js开发，后续会有相关的学习笔记，来整理学习的过程。</p>\n"},{"title":"Electron 安装","date":"2016-11-12T04:12:45.000Z","_content":"\n&nbsp;&nbsp;&nbsp;&nbsp;对于node.js的各种模块安装，最头疼的莫过于下载了。安装包体积巨大，GFW功能强大，服务器在国外，下载成功的几率很小。因此Electron的安装也是很麻烦的。\n\n### 解决方案：\n1、在安装步骤执行到 ` > node install.js ` 时，按ctrl+c中断过程\n2、阅读install.js的源代码\n3、找到使用本地缓存的逻辑\n4、手动下载zip文件，建立本地缓存，之后使用本地文件进行安装\n\n\n### 步骤：\n1、下载所需的zip包，我在mac环境下的下载路径是\n> [https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip](https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip)\n\n2、本地缓存目录为\n> ~/.electron/electron-v1.4.5-darwin-x64.zip\n\n3、手动下载的zip包放到缓存目录所在位置。\n\n4、重新执行 ` npm install -g electron ` 即可\n\n\n### 授人以渔\n上面的下载地址和缓存目录是通过阅读install.js脚本，尝试执行并打印部分变量得到的。\n对于很多其它的使用npm安装的功能模块，都可以通过这个方法，解决下载问题。","source":"_posts/electron-setup.md","raw":"---\ntitle: Electron 安装\ndate: 2016-11-12 12:12:45\ntags: Electron\ncategory: Electron\n---\n\n&nbsp;&nbsp;&nbsp;&nbsp;对于node.js的各种模块安装，最头疼的莫过于下载了。安装包体积巨大，GFW功能强大，服务器在国外，下载成功的几率很小。因此Electron的安装也是很麻烦的。\n\n### 解决方案：\n1、在安装步骤执行到 ` > node install.js ` 时，按ctrl+c中断过程\n2、阅读install.js的源代码\n3、找到使用本地缓存的逻辑\n4、手动下载zip文件，建立本地缓存，之后使用本地文件进行安装\n\n\n### 步骤：\n1、下载所需的zip包，我在mac环境下的下载路径是\n> [https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip](https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip)\n\n2、本地缓存目录为\n> ~/.electron/electron-v1.4.5-darwin-x64.zip\n\n3、手动下载的zip包放到缓存目录所在位置。\n\n4、重新执行 ` npm install -g electron ` 即可\n\n\n### 授人以渔\n上面的下载地址和缓存目录是通过阅读install.js脚本，尝试执行并打印部分变量得到的。\n对于很多其它的使用npm安装的功能模块，都可以通过这个方法，解决下载问题。","slug":"electron-setup","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklyc0005r6rlk7logjz2","content":"<p>&nbsp;&nbsp;&nbsp;&nbsp;对于node.js的各种模块安装，最头疼的莫过于下载了。安装包体积巨大，GFW功能强大，服务器在国外，下载成功的几率很小。因此Electron的安装也是很麻烦的。</p>\n<h3 id=\"解决方案：\"><a href=\"#解决方案：\" class=\"headerlink\" title=\"解决方案：\"></a>解决方案：</h3><p>1、在安装步骤执行到 <code>&gt; node install.js</code> 时，按ctrl+c中断过程<br>2、阅读install.js的源代码<br>3、找到使用本地缓存的逻辑<br>4、手动下载zip文件，建立本地缓存，之后使用本地文件进行安装</p>\n<h3 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h3><p>1、下载所需的zip包，我在mac环境下的下载路径是</p>\n<blockquote>\n<p><a href=\"https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip\">https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip</a></p>\n</blockquote>\n<p>2、本地缓存目录为</p>\n<blockquote>\n<p>~/.electron/electron-v1.4.5-darwin-x64.zip</p>\n</blockquote>\n<p>3、手动下载的zip包放到缓存目录所在位置。</p>\n<p>4、重新执行 <code>npm install -g electron</code> 即可</p>\n<h3 id=\"授人以渔\"><a href=\"#授人以渔\" class=\"headerlink\" title=\"授人以渔\"></a>授人以渔</h3><p>上面的下载地址和缓存目录是通过阅读install.js脚本，尝试执行并打印部分变量得到的。<br>对于很多其它的使用npm安装的功能模块，都可以通过这个方法，解决下载问题。</p>\n","excerpt":"","more":"<p>&nbsp;&nbsp;&nbsp;&nbsp;对于node.js的各种模块安装，最头疼的莫过于下载了。安装包体积巨大，GFW功能强大，服务器在国外，下载成功的几率很小。因此Electron的安装也是很麻烦的。</p>\n<h3 id=\"解决方案：\"><a href=\"#解决方案：\" class=\"headerlink\" title=\"解决方案：\"></a>解决方案：</h3><p>1、在安装步骤执行到 <code>&gt; node install.js</code> 时，按ctrl+c中断过程<br>2、阅读install.js的源代码<br>3、找到使用本地缓存的逻辑<br>4、手动下载zip文件，建立本地缓存，之后使用本地文件进行安装</p>\n<h3 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h3><p>1、下载所需的zip包，我在mac环境下的下载路径是</p>\n<blockquote>\n<p><a href=\"https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip\">https://github.com/electron/electron/releases/download/v1.4.5/electron-v1.4.5-darwin-x64.zip</a></p>\n</blockquote>\n<p>2、本地缓存目录为</p>\n<blockquote>\n<p>~/.electron/electron-v1.4.5-darwin-x64.zip</p>\n</blockquote>\n<p>3、手动下载的zip包放到缓存目录所在位置。</p>\n<p>4、重新执行 <code>npm install -g electron</code> 即可</p>\n<h3 id=\"授人以渔\"><a href=\"#授人以渔\" class=\"headerlink\" title=\"授人以渔\"></a>授人以渔</h3><p>上面的下载地址和缓存目录是通过阅读install.js脚本，尝试执行并打印部分变量得到的。<br>对于很多其它的使用npm安装的功能模块，都可以通过这个方法，解决下载问题。</p>\n"},{"title":"pomelo简介","date":"2017-06-25T16:15:44.000Z","_content":"\n### pomelo简介\n\npomelo 是网易推出的一个基于nodejs的服务端框架，主要用于游戏服务器端的开发。\n\n这个框架又很多值得学习的地方，包括负载均衡，通信，架构，逻辑调度等等，总之一句话，当今游戏服务器所需的特性在这个框架里都能够有所体现。\n\n但是要想用它做企业开发，还是需要费一番功夫的。毕竟框架还是比较简陋，很多地方不是足够的方便。\n\n近期在研究nodejs相关的桌面及服务器相关的逻辑。也许会有一些踩坑的笔记留下来。\n\n有兴趣的童鞋可以关注一下。\n\n","source":"_posts/pomelo.md","raw":"---\ntitle: pomelo简介\ndate: 2017-06-26 00:15:44\ntags: nodejs\ncategory: node.js\n---\n\n### pomelo简介\n\npomelo 是网易推出的一个基于nodejs的服务端框架，主要用于游戏服务器端的开发。\n\n这个框架又很多值得学习的地方，包括负载均衡，通信，架构，逻辑调度等等，总之一句话，当今游戏服务器所需的特性在这个框架里都能够有所体现。\n\n但是要想用它做企业开发，还是需要费一番功夫的。毕竟框架还是比较简陋，很多地方不是足够的方便。\n\n近期在研究nodejs相关的桌面及服务器相关的逻辑。也许会有一些踩坑的笔记留下来。\n\n有兴趣的童鞋可以关注一下。\n\n","slug":"pomelo","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklyf0006r6rljm23w7fw","content":"<h3 id=\"pomelo简介\"><a href=\"#pomelo简介\" class=\"headerlink\" title=\"pomelo简介\"></a>pomelo简介</h3><p>pomelo 是网易推出的一个基于nodejs的服务端框架，主要用于游戏服务器端的开发。</p>\n<p>这个框架又很多值得学习的地方，包括负载均衡，通信，架构，逻辑调度等等，总之一句话，当今游戏服务器所需的特性在这个框架里都能够有所体现。</p>\n<p>但是要想用它做企业开发，还是需要费一番功夫的。毕竟框架还是比较简陋，很多地方不是足够的方便。</p>\n<p>近期在研究nodejs相关的桌面及服务器相关的逻辑。也许会有一些踩坑的笔记留下来。</p>\n<p>有兴趣的童鞋可以关注一下。</p>\n","excerpt":"","more":"<h3 id=\"pomelo简介\"><a href=\"#pomelo简介\" class=\"headerlink\" title=\"pomelo简介\"></a>pomelo简介</h3><p>pomelo 是网易推出的一个基于nodejs的服务端框架，主要用于游戏服务器端的开发。</p>\n<p>这个框架又很多值得学习的地方，包括负载均衡，通信，架构，逻辑调度等等，总之一句话，当今游戏服务器所需的特性在这个框架里都能够有所体现。</p>\n<p>但是要想用它做企业开发，还是需要费一番功夫的。毕竟框架还是比较简陋，很多地方不是足够的方便。</p>\n<p>近期在研究nodejs相关的桌面及服务器相关的逻辑。也许会有一些踩坑的笔记留下来。</p>\n<p>有兴趣的童鞋可以关注一下。</p>\n"},{"title":"第一篇文章","date":"2016-11-10T09:50:52.000Z","_content":"\n一直想坚持写博客，但是结果总是各种站点被关停，因此很久都没有好好写过博客。\n\n最近终于下定决心，在github上创建了自己的博客站点，以后会经常来更新点东西。权当自己的日常笔记。\n\n希望有兴趣的朋友来坐坐。\n","source":"_posts/hello-world.md","raw":"---\ntitle: 第一篇文章\ndate: 2016-11-10 17:50:52\n---\n\n一直想坚持写博客，但是结果总是各种站点被关停，因此很久都没有好好写过博客。\n\n最近终于下定决心，在github上创建了自己的博客站点，以后会经常来更新点东西。权当自己的日常笔记。\n\n希望有兴趣的朋友来坐坐。\n","slug":"hello-world","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklyi000ar6rlg35hfyjp","content":"<p>一直想坚持写博客，但是结果总是各种站点被关停，因此很久都没有好好写过博客。</p>\n<p>最近终于下定决心，在github上创建了自己的博客站点，以后会经常来更新点东西。权当自己的日常笔记。</p>\n<p>希望有兴趣的朋友来坐坐。</p>\n","excerpt":"","more":"<p>一直想坚持写博客，但是结果总是各种站点被关停，因此很久都没有好好写过博客。</p>\n<p>最近终于下定决心，在github上创建了自己的博客站点，以后会经常来更新点东西。权当自己的日常笔记。</p>\n<p>希望有兴趣的朋友来坐坐。</p>\n"},{"title":"AndoridSDK镜像地址","date":"2017-02-07T02:12:12.000Z","_content":"\n很多Android开发者都会面临GFW的封杀，我们也是各种见招拆招。\n昨天突然发现腾讯干了一件非常利国利民的事情，那就是提供了一个下载速度相当可观的镜像站点。\n\n站点地址:[http://android-mirror.bugly.qq.com:8080/](http://android-mirror.bugly.qq.com:8080/)\n\n这里有xcode，unity，adt，androidSDK，NDK，eclipse，JDK等资源提供下载，并且可以作为androidSDK的更新镜像使用，具体的使用方法也给出了详细的图文帮助\n\n[点击这里查看帮助](http://android-mirror.bugly.qq.com:8080/include/usage.html)\n\n\n希望对大家有所帮助\n\n\n","source":"_posts/qq-mirr.md","raw":"---\ntitle: AndoridSDK镜像地址\ndate: 2017-02-07 10:12:12\ntags: Android\ncategory: Android\n---\n\n很多Android开发者都会面临GFW的封杀，我们也是各种见招拆招。\n昨天突然发现腾讯干了一件非常利国利民的事情，那就是提供了一个下载速度相当可观的镜像站点。\n\n站点地址:[http://android-mirror.bugly.qq.com:8080/](http://android-mirror.bugly.qq.com:8080/)\n\n这里有xcode，unity，adt，androidSDK，NDK，eclipse，JDK等资源提供下载，并且可以作为androidSDK的更新镜像使用，具体的使用方法也给出了详细的图文帮助\n\n[点击这里查看帮助](http://android-mirror.bugly.qq.com:8080/include/usage.html)\n\n\n希望对大家有所帮助\n\n\n","slug":"qq-mirr","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklyl000cr6rlicowo3qm","content":"<p>很多Android开发者都会面临GFW的封杀，我们也是各种见招拆招。<br>昨天突然发现腾讯干了一件非常利国利民的事情，那就是提供了一个下载速度相当可观的镜像站点。</p>\n<p>站点地址:<a href=\"http://android-mirror.bugly.qq.com:8080/\">http://android-mirror.bugly.qq.com:8080/</a></p>\n<p>这里有xcode，unity，adt，androidSDK，NDK，eclipse，JDK等资源提供下载，并且可以作为androidSDK的更新镜像使用，具体的使用方法也给出了详细的图文帮助</p>\n<p><a href=\"http://android-mirror.bugly.qq.com:8080/include/usage.html\">点击这里查看帮助</a></p>\n<p>希望对大家有所帮助</p>\n","excerpt":"","more":"<p>很多Android开发者都会面临GFW的封杀，我们也是各种见招拆招。<br>昨天突然发现腾讯干了一件非常利国利民的事情，那就是提供了一个下载速度相当可观的镜像站点。</p>\n<p>站点地址:<a href=\"http://android-mirror.bugly.qq.com:8080/\">http://android-mirror.bugly.qq.com:8080/</a></p>\n<p>这里有xcode，unity，adt，androidSDK，NDK，eclipse，JDK等资源提供下载，并且可以作为androidSDK的更新镜像使用，具体的使用方法也给出了详细的图文帮助</p>\n<p><a href=\"http://android-mirror.bugly.qq.com:8080/include/usage.html\">点击这里查看帮助</a></p>\n<p>希望对大家有所帮助</p>\n"},{"title":"网络API整理","date":"2017-02-07T03:19:36.000Z","_content":"\n收集整理了一些可能用到的网络API，便于编程时使用，适合没有自己的服务器的开发人员。\n\n1. 获取北京时间API\n` http://www.114time.com/api/clock.php `\n","source":"_posts/storage.md","raw":"---\ntitle: 网络API整理\ndate: 2017-02-07 11:19:36\ntags: 网络资源\ncategory: 网络资源\n---\n\n收集整理了一些可能用到的网络API，便于编程时使用，适合没有自己的服务器的开发人员。\n\n1. 获取北京时间API\n` http://www.114time.com/api/clock.php `\n","slug":"storage","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklyo000fr6rlb6ttwtvc","content":"<p>收集整理了一些可能用到的网络API，便于编程时使用，适合没有自己的服务器的开发人员。</p>\n<ol>\n<li>获取北京时间API<br><code>http://www.114time.com/api/clock.php</code></li>\n</ol>\n","excerpt":"","more":"<p>收集整理了一些可能用到的网络API，便于编程时使用，适合没有自己的服务器的开发人员。</p>\n<ol>\n<li>获取北京时间API<br><code>http://www.114time.com/api/clock.php</code></li>\n</ol>\n"},{"title":"风格修改","date":"2016-11-10T09:52:52.000Z","_content":"\n### 新的风格\n\n#### 修改了一次标题风格\n\n背景改为了黑色，与前景色互换了，这样更符合程序员的习惯，而且看多了，也不会觉得累。\n\n按照管理，应当有一些仪式性的东西。比如，helloworld\n\n```javaScript\ndocument.write(\"Hello Coldwinter's blog\");\n```\n\n```lua\nprint('Hello Coldwinter's blog')\n```\n\n```C++\nprintf(\"%s\",\"Hello Coldwinter's blog\");\n```\n\n```php\necho \"Hello Coldwinter's blog\";\n```\n\n\n> 各种代码的高亮\n\n1. 表格的支持\n2. 有序的\n\n* 无序的\n* 以及不知道是什么的","source":"_posts/style.md","raw":"---\ntitle: 风格修改\ndate: 2016-11-10 17:52:52\ntags: 日记\n---\n\n### 新的风格\n\n#### 修改了一次标题风格\n\n背景改为了黑色，与前景色互换了，这样更符合程序员的习惯，而且看多了，也不会觉得累。\n\n按照管理，应当有一些仪式性的东西。比如，helloworld\n\n```javaScript\ndocument.write(\"Hello Coldwinter's blog\");\n```\n\n```lua\nprint('Hello Coldwinter's blog')\n```\n\n```C++\nprintf(\"%s\",\"Hello Coldwinter's blog\");\n```\n\n```php\necho \"Hello Coldwinter's blog\";\n```\n\n\n> 各种代码的高亮\n\n1. 表格的支持\n2. 有序的\n\n* 无序的\n* 以及不知道是什么的","slug":"style","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklyq000ir6rl9ldp6689","content":"<h3 id=\"新的风格\"><a href=\"#新的风格\" class=\"headerlink\" title=\"新的风格\"></a>新的风格</h3><h4 id=\"修改了一次标题风格\"><a href=\"#修改了一次标题风格\" class=\"headerlink\" title=\"修改了一次标题风格\"></a>修改了一次标题风格</h4><p>背景改为了黑色，与前景色互换了，这样更符合程序员的习惯，而且看多了，也不会觉得累。</p>\n<p>按照管理，应当有一些仪式性的东西。比如，helloworld</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">document</span>.write(<span class=\"string\">\"Hello Coldwinter's blog\"</span>);</div></pre></td></tr></table></figure>\n<figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">'Hello Coldwinter'</span>s blog<span class=\"string\">')</span></div></pre></td></tr></table></figure>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\"</span>,<span class=\"string\">\"Hello Coldwinter's blog\"</span>);</div></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">\"Hello Coldwinter's blog\"</span>;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>各种代码的高亮</p>\n</blockquote>\n<ol>\n<li>表格的支持</li>\n<li>有序的</li>\n</ol>\n<ul>\n<li>无序的</li>\n<li>以及不知道是什么的</li>\n</ul>\n","excerpt":"","more":"<h3 id=\"新的风格\"><a href=\"#新的风格\" class=\"headerlink\" title=\"新的风格\"></a>新的风格</h3><h4 id=\"修改了一次标题风格\"><a href=\"#修改了一次标题风格\" class=\"headerlink\" title=\"修改了一次标题风格\"></a>修改了一次标题风格</h4><p>背景改为了黑色，与前景色互换了，这样更符合程序员的习惯，而且看多了，也不会觉得累。</p>\n<p>按照管理，应当有一些仪式性的东西。比如，helloworld</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">document</span>.write(<span class=\"string\">\"Hello Coldwinter's blog\"</span>);</div></pre></td></tr></table></figure>\n<figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">'Hello Coldwinter'</span>s blog<span class=\"string\">')</span></div></pre></td></tr></table></figure>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\"</span>,<span class=\"string\">\"Hello Coldwinter's blog\"</span>);</div></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">\"Hello Coldwinter's blog\"</span>;</div></pre></td></tr></table></figure>\n<blockquote>\n<p>各种代码的高亮</p>\n</blockquote>\n<ol>\n<li>表格的支持</li>\n<li>有序的</li>\n</ol>\n<ul>\n<li>无序的</li>\n<li>以及不知道是什么的</li>\n</ul>\n"},{"title":"Express + socket.io 聊天程序","date":"2016-11-17T05:44:59.000Z","_content":"\n\n### 基础环境\n\n\n1. 下载安装node.js(自行百度）\n2. 安装npm（自行百度）\n3. 创建工程目录 ` mkdir webSocket ` 并且切换到该目录\n4. 在webSocket下创建npm工程 ` npm init ` 按照提示完成\n5. 安装express ` npm install express ` (注意，此处非全局安装)\n6. 安装socket.io ` npm install socket.io ` (同上)\n7. 创建web目录www ` mkdir www `\n8. 创建js目录 ` mkdir www/js ` （这一步在本文内无用，是用来放客户端js代码的)\n9. 在js目录中安装socket.io.js,这个文件在 `node\\_modules/socket.io\\_client` 内\n10. 创建相应的 `index.js`、`www/index.html`文件\n\n\n### 详细说明\n\n#### 服务端\n\n先帖代码\n\n```javascript\nvar express = require('express');\nvar app = express();\nserver = app.listen(8000,function()\n{\n    console.log('服务器启动:http://localhost:8000');\n});\nio = require('socket.io').listen(server);\n\t\napp.use('/',express.static(__dirname + '/www'));\n\t\n//在线用户\nvar onlineUsers = {};\n//当前在线人数\nvar onlineCount = 0;\n\t\nio.on('connection', function(socket){\n\t\n\tconsole.log(socket.id);\n\tif(!onlineUsers.hasOwnProperty(socket.id)) {\n\t\tonlineUsers[socket.id] = socket;\n\t\t//在线人数+1\n\t\tonlineCount++;\n\t}\n\t\n\tsocket.emit('login',{user:socket.id, count:onlineCount});\n\t\n\tio.emit('enter', {count:onlineCount, user:socket.id});\n\tconsole.log('用户'+socket.id + \" 加入的房间，当前在线人数:\" + onlineCount);\n\t//监听用户退出\n\tsocket.on('disconnect', function()\n\t{\n\t\t//将退出的用户从在线列表中删除\n\t\tif(onlineUsers.hasOwnProperty(socket.id)) {\n\t\t\t//退出用户的信息\n\t\t\t//删除\n\t\t\tdelete onlineUsers[socket.id];\n\t\t\t//在线人数-1\n\t\t\tonlineCount--;\n\t\n\t\t\t//向所有客户端广播用户退出\n\t\t\tio.emit('logout', { count:onlineCount, user:socket.id});\n\t\t\t// console.log(socket.id+'退出了聊天室');\n\t\t}\n        console.log(socket.id +'退出了房间,当前房间人数:' + onlineCount);\n\t});\n\t\n\t//监听用户发布聊天内容\n\tsocket.on('msg', function(obj){\n\t\t//向所有客户端广播发布的消息\n\t\tio.emit('msg', {user:socket.id, msg:obj,count:onlineCount});\n\t\tconsole.log(socket.id+'说：'+obj);\n\t});\n});\n```\n\n\n##### 说明：\n\n不同于网上其它的例子，这里直接用express的对象启动监听，就可以返回一个server对象。\n如果希望监听在逻辑的最后执行，可以先执行创建server(`createServer`)，再监听。\n另外，选择8000端口，是因为，在mac下，访问80端口需要相应的权限，因此避免用此端口可以免去开发中的一些麻烦。等正式环境再做调整。\n\n\n\n#### 客户端\n\n客户端的代码结合的jquery来使用，我只帖重点部分。\n\n\n```javascript\n<body>\n    <script src=\"socket.io/socket.io.js\"></script>\n    <script src=\"js/jquery-3.1.1.min.js\"></script>\n    <script>\n\n\n    var user_id = '';\n\n\n    $(document).ready(function(){\n\n        var socket=io.connect();//与服务器进行连接\n\n        $(\"#send\").click(function(){\n            var data = $(\"#text\").val();\n            socket.emit('msg', data );\n            $(\"#msg\").val( $(\"#msg\").val() + \"\\n我:\" + data ); \n        })\n\n        socket.on('enter',function(data){\n            \n            $(\"#online\").val('当前在线人数:' + data.count);\n\n        });\n\n        socket.on('logout',function(data){\n            $(\"#online\").val('当前在线人数:' + data.count);\n        });\n\n        socket.on('login',function(data){\n            user_id = data.user;\n            $(\"#online\").val('当前在线人数:' + data.count);\n        });\n\n        socket.on('msg',function(data){\n            $(\"#online\").val('当前在线人数:' + data.count);\n            if(data.user == user_id) return;\n            $(\"#msg\").val( $(\"#msg\").val() + \"\\n\" + data.user +':'+data.msg);\n\n\n        })\n\n    })\n\n    </script>\n    ......\n```\n   \n##### 说明\n引入的js文件 `socket.io/socket.io.js` 这个是由服务器创建的访问，我们不必真的创建一个目录来存放一个真实的socket.io.js文件，当然，如果你的站点动静分离，或者有特别的需求，可以从网站下载相应的文件，放在相应的目录下提供访问，也是完全没有问题的。\n\n具体socket的绑定事件，可以从[socket.io官方](http://socket.io)的文档里找到相应的内容。\n\n\n### 写在最后\n\n本文只是为了贴一段代码，做一个备忘。这部分内容还会继续深入学习，这个笔记很持续更新一段时间，直到我搞清楚webSocket为止。\n\n下面附上我自己的各组件版本\n\n```\nnode.js    v6.9.1\nsocket.io  1.5.1\nsocket.io_client  1.4.5\nexpress    4.14.0\n\n```\n\n踩过此坑，特此记录","source":"_posts/websocket.md","raw":"---\ntitle: Express + socket.io 聊天程序\ndate: 2016-11-17 13:44:59\ntags: \n- webSocket\n- socket.io\ncategory: \n- node.js\n- webSocket\n---\n\n\n### 基础环境\n\n\n1. 下载安装node.js(自行百度）\n2. 安装npm（自行百度）\n3. 创建工程目录 ` mkdir webSocket ` 并且切换到该目录\n4. 在webSocket下创建npm工程 ` npm init ` 按照提示完成\n5. 安装express ` npm install express ` (注意，此处非全局安装)\n6. 安装socket.io ` npm install socket.io ` (同上)\n7. 创建web目录www ` mkdir www `\n8. 创建js目录 ` mkdir www/js ` （这一步在本文内无用，是用来放客户端js代码的)\n9. 在js目录中安装socket.io.js,这个文件在 `node\\_modules/socket.io\\_client` 内\n10. 创建相应的 `index.js`、`www/index.html`文件\n\n\n### 详细说明\n\n#### 服务端\n\n先帖代码\n\n```javascript\nvar express = require('express');\nvar app = express();\nserver = app.listen(8000,function()\n{\n    console.log('服务器启动:http://localhost:8000');\n});\nio = require('socket.io').listen(server);\n\t\napp.use('/',express.static(__dirname + '/www'));\n\t\n//在线用户\nvar onlineUsers = {};\n//当前在线人数\nvar onlineCount = 0;\n\t\nio.on('connection', function(socket){\n\t\n\tconsole.log(socket.id);\n\tif(!onlineUsers.hasOwnProperty(socket.id)) {\n\t\tonlineUsers[socket.id] = socket;\n\t\t//在线人数+1\n\t\tonlineCount++;\n\t}\n\t\n\tsocket.emit('login',{user:socket.id, count:onlineCount});\n\t\n\tio.emit('enter', {count:onlineCount, user:socket.id});\n\tconsole.log('用户'+socket.id + \" 加入的房间，当前在线人数:\" + onlineCount);\n\t//监听用户退出\n\tsocket.on('disconnect', function()\n\t{\n\t\t//将退出的用户从在线列表中删除\n\t\tif(onlineUsers.hasOwnProperty(socket.id)) {\n\t\t\t//退出用户的信息\n\t\t\t//删除\n\t\t\tdelete onlineUsers[socket.id];\n\t\t\t//在线人数-1\n\t\t\tonlineCount--;\n\t\n\t\t\t//向所有客户端广播用户退出\n\t\t\tio.emit('logout', { count:onlineCount, user:socket.id});\n\t\t\t// console.log(socket.id+'退出了聊天室');\n\t\t}\n        console.log(socket.id +'退出了房间,当前房间人数:' + onlineCount);\n\t});\n\t\n\t//监听用户发布聊天内容\n\tsocket.on('msg', function(obj){\n\t\t//向所有客户端广播发布的消息\n\t\tio.emit('msg', {user:socket.id, msg:obj,count:onlineCount});\n\t\tconsole.log(socket.id+'说：'+obj);\n\t});\n});\n```\n\n\n##### 说明：\n\n不同于网上其它的例子，这里直接用express的对象启动监听，就可以返回一个server对象。\n如果希望监听在逻辑的最后执行，可以先执行创建server(`createServer`)，再监听。\n另外，选择8000端口，是因为，在mac下，访问80端口需要相应的权限，因此避免用此端口可以免去开发中的一些麻烦。等正式环境再做调整。\n\n\n\n#### 客户端\n\n客户端的代码结合的jquery来使用，我只帖重点部分。\n\n\n```javascript\n<body>\n    <script src=\"socket.io/socket.io.js\"></script>\n    <script src=\"js/jquery-3.1.1.min.js\"></script>\n    <script>\n\n\n    var user_id = '';\n\n\n    $(document).ready(function(){\n\n        var socket=io.connect();//与服务器进行连接\n\n        $(\"#send\").click(function(){\n            var data = $(\"#text\").val();\n            socket.emit('msg', data );\n            $(\"#msg\").val( $(\"#msg\").val() + \"\\n我:\" + data ); \n        })\n\n        socket.on('enter',function(data){\n            \n            $(\"#online\").val('当前在线人数:' + data.count);\n\n        });\n\n        socket.on('logout',function(data){\n            $(\"#online\").val('当前在线人数:' + data.count);\n        });\n\n        socket.on('login',function(data){\n            user_id = data.user;\n            $(\"#online\").val('当前在线人数:' + data.count);\n        });\n\n        socket.on('msg',function(data){\n            $(\"#online\").val('当前在线人数:' + data.count);\n            if(data.user == user_id) return;\n            $(\"#msg\").val( $(\"#msg\").val() + \"\\n\" + data.user +':'+data.msg);\n\n\n        })\n\n    })\n\n    </script>\n    ......\n```\n   \n##### 说明\n引入的js文件 `socket.io/socket.io.js` 这个是由服务器创建的访问，我们不必真的创建一个目录来存放一个真实的socket.io.js文件，当然，如果你的站点动静分离，或者有特别的需求，可以从网站下载相应的文件，放在相应的目录下提供访问，也是完全没有问题的。\n\n具体socket的绑定事件，可以从[socket.io官方](http://socket.io)的文档里找到相应的内容。\n\n\n### 写在最后\n\n本文只是为了贴一段代码，做一个备忘。这部分内容还会继续深入学习，这个笔记很持续更新一段时间，直到我搞清楚webSocket为止。\n\n下面附上我自己的各组件版本\n\n```\nnode.js    v6.9.1\nsocket.io  1.5.1\nsocket.io_client  1.4.5\nexpress    4.14.0\n\n```\n\n踩过此坑，特此记录","slug":"websocket","published":1,"updated":"2017-06-26T01:44:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj4pdklyt000lr6rlusbqtb0u","content":"<h3 id=\"基础环境\"><a href=\"#基础环境\" class=\"headerlink\" title=\"基础环境\"></a>基础环境</h3><ol>\n<li>下载安装node.js(自行百度）</li>\n<li>安装npm（自行百度）</li>\n<li>创建工程目录 <code>mkdir webSocket</code> 并且切换到该目录</li>\n<li>在webSocket下创建npm工程 <code>npm init</code> 按照提示完成</li>\n<li>安装express <code>npm install express</code> (注意，此处非全局安装)</li>\n<li>安装socket.io <code>npm install socket.io</code> (同上)</li>\n<li>创建web目录www <code>mkdir www</code></li>\n<li>创建js目录 <code>mkdir www/js</code> （这一步在本文内无用，是用来放客户端js代码的)</li>\n<li>在js目录中安装socket.io.js,这个文件在 <code>node\\_modules/socket.io\\_client</code> 内</li>\n<li>创建相应的 <code>index.js</code>、<code>www/index.html</code>文件</li>\n</ol>\n<h3 id=\"详细说明\"><a href=\"#详细说明\" class=\"headerlink\" title=\"详细说明\"></a>详细说明</h3><h4 id=\"服务端\"><a href=\"#服务端\" class=\"headerlink\" title=\"服务端\"></a>服务端</h4><p>先帖代码</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> app = express();</div><div class=\"line\">server = app.listen(<span class=\"number\">8000</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'服务器启动:http://localhost:8000'</span>);</div><div class=\"line\">&#125;);</div><div class=\"line\">io = <span class=\"built_in\">require</span>(<span class=\"string\">'socket.io'</span>).listen(server);</div><div class=\"line\">\t</div><div class=\"line\">app.use(<span class=\"string\">'/'</span>,express.static(__dirname + <span class=\"string\">'/www'</span>));</div><div class=\"line\">\t</div><div class=\"line\"><span class=\"comment\">//在线用户</span></div><div class=\"line\"><span class=\"keyword\">var</span> onlineUsers = &#123;&#125;;</div><div class=\"line\"><span class=\"comment\">//当前在线人数</span></div><div class=\"line\"><span class=\"keyword\">var</span> onlineCount = <span class=\"number\">0</span>;</div><div class=\"line\">\t</div><div class=\"line\">io.on(<span class=\"string\">'connection'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">socket</span>)</span>&#123;</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(socket.id);</div><div class=\"line\">\t<span class=\"keyword\">if</span>(!onlineUsers.hasOwnProperty(socket.id)) &#123;</div><div class=\"line\">\t\tonlineUsers[socket.id] = socket;</div><div class=\"line\">\t\t<span class=\"comment\">//在线人数+1</span></div><div class=\"line\">\t\tonlineCount++;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t</div><div class=\"line\">\tsocket.emit(<span class=\"string\">'login'</span>,&#123;<span class=\"attr\">user</span>:socket.id, <span class=\"attr\">count</span>:onlineCount&#125;);</div><div class=\"line\">\t</div><div class=\"line\">\tio.emit(<span class=\"string\">'enter'</span>, &#123;<span class=\"attr\">count</span>:onlineCount, <span class=\"attr\">user</span>:socket.id&#125;);</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'用户'</span>+socket.id + <span class=\"string\">\" 加入的房间，当前在线人数:\"</span> + onlineCount);</div><div class=\"line\">\t<span class=\"comment\">//监听用户退出</span></div><div class=\"line\">\tsocket.on(<span class=\"string\">'disconnect'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</div><div class=\"line\">\t</span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//将退出的用户从在线列表中删除</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(onlineUsers.hasOwnProperty(socket.id)) &#123;</div><div class=\"line\">\t\t\t<span class=\"comment\">//退出用户的信息</span></div><div class=\"line\">\t\t\t<span class=\"comment\">//删除</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">delete</span> onlineUsers[socket.id];</div><div class=\"line\">\t\t\t<span class=\"comment\">//在线人数-1</span></div><div class=\"line\">\t\t\tonlineCount--;</div><div class=\"line\">\t</div><div class=\"line\">\t\t\t<span class=\"comment\">//向所有客户端广播用户退出</span></div><div class=\"line\">\t\t\tio.emit(<span class=\"string\">'logout'</span>, &#123; <span class=\"attr\">count</span>:onlineCount, <span class=\"attr\">user</span>:socket.id&#125;);</div><div class=\"line\">\t\t\t<span class=\"comment\">// console.log(socket.id+'退出了聊天室');</span></div><div class=\"line\">\t\t&#125;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(socket.id +<span class=\"string\">'退出了房间,当前房间人数:'</span> + onlineCount);</div><div class=\"line\">\t&#125;);</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"comment\">//监听用户发布聊天内容</span></div><div class=\"line\">\tsocket.on(<span class=\"string\">'msg'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">obj</span>)</span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//向所有客户端广播发布的消息</span></div><div class=\"line\">\t\tio.emit(<span class=\"string\">'msg'</span>, &#123;<span class=\"attr\">user</span>:socket.id, <span class=\"attr\">msg</span>:obj,<span class=\"attr\">count</span>:onlineCount&#125;);</div><div class=\"line\">\t\t<span class=\"built_in\">console</span>.log(socket.id+<span class=\"string\">'说：'</span>+obj);</div><div class=\"line\">\t&#125;);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h5 id=\"说明：\"><a href=\"#说明：\" class=\"headerlink\" title=\"说明：\"></a>说明：</h5><p>不同于网上其它的例子，这里直接用express的对象启动监听，就可以返回一个server对象。<br>如果希望监听在逻辑的最后执行，可以先执行创建server(<code>createServer</code>)，再监听。<br>另外，选择8000端口，是因为，在mac下，访问80端口需要相应的权限，因此避免用此端口可以免去开发中的一些麻烦。等正式环境再做调整。</p>\n<h4 id=\"客户端\"><a href=\"#客户端\" class=\"headerlink\" title=\"客户端\"></a>客户端</h4><p>客户端的代码结合的jquery来使用，我只帖重点部分。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;body&gt;</div><div class=\"line\">    &lt;script src=\"socket.io/socket.io.js\"&gt;&lt;/script&gt;</div><div class=\"line\">    &lt;script src=\"js/jquery-3.1.1.min.js\"&gt;&lt;/script&gt;</div><div class=\"line\">    &lt;script&gt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    var user_id = '';</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    $(document).ready(function()&#123;</div><div class=\"line\"></div><div class=\"line\">        var socket=io.connect();//与服务器进行连接</div><div class=\"line\"></div><div class=\"line\">        $(\"#send\").click(function()&#123;</div><div class=\"line\">            var data = $(\"#text\").val();</div><div class=\"line\">            socket.emit('msg', data );</div><div class=\"line\">            $(\"#msg\").val( $(\"#msg\").val() + \"\\n我:\" + data ); </div><div class=\"line\">        &#125;)</div><div class=\"line\"></div><div class=\"line\">        socket.on('enter',function(data)&#123;</div><div class=\"line\">            </div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\"></div><div class=\"line\">        &#125;);</div><div class=\"line\"></div><div class=\"line\">        socket.on('logout',function(data)&#123;</div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\">        &#125;);</div><div class=\"line\"></div><div class=\"line\">        socket.on('login',function(data)&#123;</div><div class=\"line\">            user_id = data.user;</div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\">        &#125;);</div><div class=\"line\"></div><div class=\"line\">        socket.on('msg',function(data)&#123;</div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\">            if(data.user == user_id) return;</div><div class=\"line\">            $(\"#msg\").val( $(\"#msg\").val() + \"\\n\" + data.user +':'+data.msg);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">        &#125;)</div><div class=\"line\"></div><div class=\"line\">    &#125;)</div><div class=\"line\"></div><div class=\"line\">    &lt;/script&gt;</div><div class=\"line\">    ......</div></pre></td></tr></table></figure>\n<h5 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h5><p>引入的js文件 <code>socket.io/socket.io.js</code> 这个是由服务器创建的访问，我们不必真的创建一个目录来存放一个真实的socket.io.js文件，当然，如果你的站点动静分离，或者有特别的需求，可以从网站下载相应的文件，放在相应的目录下提供访问，也是完全没有问题的。</p>\n<p>具体socket的绑定事件，可以从<a href=\"http://socket.io\">socket.io官方</a>的文档里找到相应的内容。</p>\n<h3 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h3><p>本文只是为了贴一段代码，做一个备忘。这部分内容还会继续深入学习，这个笔记很持续更新一段时间，直到我搞清楚webSocket为止。</p>\n<p>下面附上我自己的各组件版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">node.js    v6.9.1</div><div class=\"line\">socket.io  1.5.1</div><div class=\"line\">socket.io_client  1.4.5</div><div class=\"line\">express    4.14.0</div></pre></td></tr></table></figure>\n<p>踩过此坑，特此记录</p>\n","excerpt":"","more":"<h3 id=\"基础环境\"><a href=\"#基础环境\" class=\"headerlink\" title=\"基础环境\"></a>基础环境</h3><ol>\n<li>下载安装node.js(自行百度）</li>\n<li>安装npm（自行百度）</li>\n<li>创建工程目录 <code>mkdir webSocket</code> 并且切换到该目录</li>\n<li>在webSocket下创建npm工程 <code>npm init</code> 按照提示完成</li>\n<li>安装express <code>npm install express</code> (注意，此处非全局安装)</li>\n<li>安装socket.io <code>npm install socket.io</code> (同上)</li>\n<li>创建web目录www <code>mkdir www</code></li>\n<li>创建js目录 <code>mkdir www/js</code> （这一步在本文内无用，是用来放客户端js代码的)</li>\n<li>在js目录中安装socket.io.js,这个文件在 <code>node\\_modules/socket.io\\_client</code> 内</li>\n<li>创建相应的 <code>index.js</code>、<code>www/index.html</code>文件</li>\n</ol>\n<h3 id=\"详细说明\"><a href=\"#详细说明\" class=\"headerlink\" title=\"详细说明\"></a>详细说明</h3><h4 id=\"服务端\"><a href=\"#服务端\" class=\"headerlink\" title=\"服务端\"></a>服务端</h4><p>先帖代码</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</div><div class=\"line\"><span class=\"keyword\">var</span> app = express();</div><div class=\"line\">server = app.listen(<span class=\"number\">8000</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</div><div class=\"line\"></span>&#123;</div><div class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">'服务器启动:http://localhost:8000'</span>);</div><div class=\"line\">&#125;);</div><div class=\"line\">io = <span class=\"built_in\">require</span>(<span class=\"string\">'socket.io'</span>).listen(server);</div><div class=\"line\">\t</div><div class=\"line\">app.use(<span class=\"string\">'/'</span>,express.static(__dirname + <span class=\"string\">'/www'</span>));</div><div class=\"line\">\t</div><div class=\"line\"><span class=\"comment\">//在线用户</span></div><div class=\"line\"><span class=\"keyword\">var</span> onlineUsers = &#123;&#125;;</div><div class=\"line\"><span class=\"comment\">//当前在线人数</span></div><div class=\"line\"><span class=\"keyword\">var</span> onlineCount = <span class=\"number\">0</span>;</div><div class=\"line\">\t</div><div class=\"line\">io.on(<span class=\"string\">'connection'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">socket</span>)</span>&#123;</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(socket.id);</div><div class=\"line\">\t<span class=\"keyword\">if</span>(!onlineUsers.hasOwnProperty(socket.id)) &#123;</div><div class=\"line\">\t\tonlineUsers[socket.id] = socket;</div><div class=\"line\">\t\t<span class=\"comment\">//在线人数+1</span></div><div class=\"line\">\t\tonlineCount++;</div><div class=\"line\">\t&#125;</div><div class=\"line\">\t</div><div class=\"line\">\tsocket.emit(<span class=\"string\">'login'</span>,&#123;<span class=\"attr\">user</span>:socket.id, <span class=\"attr\">count</span>:onlineCount&#125;);</div><div class=\"line\">\t</div><div class=\"line\">\tio.emit(<span class=\"string\">'enter'</span>, &#123;<span class=\"attr\">count</span>:onlineCount, <span class=\"attr\">user</span>:socket.id&#125;);</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'用户'</span>+socket.id + <span class=\"string\">\" 加入的房间，当前在线人数:\"</span> + onlineCount);</div><div class=\"line\">\t<span class=\"comment\">//监听用户退出</span></div><div class=\"line\">\tsocket.on(<span class=\"string\">'disconnect'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</div><div class=\"line\">\t</span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//将退出的用户从在线列表中删除</span></div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(onlineUsers.hasOwnProperty(socket.id)) &#123;</div><div class=\"line\">\t\t\t<span class=\"comment\">//退出用户的信息</span></div><div class=\"line\">\t\t\t<span class=\"comment\">//删除</span></div><div class=\"line\">\t\t\t<span class=\"keyword\">delete</span> onlineUsers[socket.id];</div><div class=\"line\">\t\t\t<span class=\"comment\">//在线人数-1</span></div><div class=\"line\">\t\t\tonlineCount--;</div><div class=\"line\">\t</div><div class=\"line\">\t\t\t<span class=\"comment\">//向所有客户端广播用户退出</span></div><div class=\"line\">\t\t\tio.emit(<span class=\"string\">'logout'</span>, &#123; <span class=\"attr\">count</span>:onlineCount, <span class=\"attr\">user</span>:socket.id&#125;);</div><div class=\"line\">\t\t\t<span class=\"comment\">// console.log(socket.id+'退出了聊天室');</span></div><div class=\"line\">\t\t&#125;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(socket.id +<span class=\"string\">'退出了房间,当前房间人数:'</span> + onlineCount);</div><div class=\"line\">\t&#125;);</div><div class=\"line\">\t</div><div class=\"line\">\t<span class=\"comment\">//监听用户发布聊天内容</span></div><div class=\"line\">\tsocket.on(<span class=\"string\">'msg'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">obj</span>)</span>&#123;</div><div class=\"line\">\t\t<span class=\"comment\">//向所有客户端广播发布的消息</span></div><div class=\"line\">\t\tio.emit(<span class=\"string\">'msg'</span>, &#123;<span class=\"attr\">user</span>:socket.id, <span class=\"attr\">msg</span>:obj,<span class=\"attr\">count</span>:onlineCount&#125;);</div><div class=\"line\">\t\t<span class=\"built_in\">console</span>.log(socket.id+<span class=\"string\">'说：'</span>+obj);</div><div class=\"line\">\t&#125;);</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h5 id=\"说明：\"><a href=\"#说明：\" class=\"headerlink\" title=\"说明：\"></a>说明：</h5><p>不同于网上其它的例子，这里直接用express的对象启动监听，就可以返回一个server对象。<br>如果希望监听在逻辑的最后执行，可以先执行创建server(<code>createServer</code>)，再监听。<br>另外，选择8000端口，是因为，在mac下，访问80端口需要相应的权限，因此避免用此端口可以免去开发中的一些麻烦。等正式环境再做调整。</p>\n<h4 id=\"客户端\"><a href=\"#客户端\" class=\"headerlink\" title=\"客户端\"></a>客户端</h4><p>客户端的代码结合的jquery来使用，我只帖重点部分。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;body&gt;</div><div class=\"line\">    &lt;script src=\"socket.io/socket.io.js\"&gt;&lt;/script&gt;</div><div class=\"line\">    &lt;script src=\"js/jquery-3.1.1.min.js\"&gt;&lt;/script&gt;</div><div class=\"line\">    &lt;script&gt;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    var user_id = '';</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    $(document).ready(function()&#123;</div><div class=\"line\"></div><div class=\"line\">        var socket=io.connect();//与服务器进行连接</div><div class=\"line\"></div><div class=\"line\">        $(\"#send\").click(function()&#123;</div><div class=\"line\">            var data = $(\"#text\").val();</div><div class=\"line\">            socket.emit('msg', data );</div><div class=\"line\">            $(\"#msg\").val( $(\"#msg\").val() + \"\\n我:\" + data ); </div><div class=\"line\">        &#125;)</div><div class=\"line\"></div><div class=\"line\">        socket.on('enter',function(data)&#123;</div><div class=\"line\">            </div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\"></div><div class=\"line\">        &#125;);</div><div class=\"line\"></div><div class=\"line\">        socket.on('logout',function(data)&#123;</div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\">        &#125;);</div><div class=\"line\"></div><div class=\"line\">        socket.on('login',function(data)&#123;</div><div class=\"line\">            user_id = data.user;</div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\">        &#125;);</div><div class=\"line\"></div><div class=\"line\">        socket.on('msg',function(data)&#123;</div><div class=\"line\">            $(\"#online\").val('当前在线人数:' + data.count);</div><div class=\"line\">            if(data.user == user_id) return;</div><div class=\"line\">            $(\"#msg\").val( $(\"#msg\").val() + \"\\n\" + data.user +':'+data.msg);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">        &#125;)</div><div class=\"line\"></div><div class=\"line\">    &#125;)</div><div class=\"line\"></div><div class=\"line\">    &lt;/script&gt;</div><div class=\"line\">    ......</div></pre></td></tr></table></figure>\n<h5 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h5><p>引入的js文件 <code>socket.io/socket.io.js</code> 这个是由服务器创建的访问，我们不必真的创建一个目录来存放一个真实的socket.io.js文件，当然，如果你的站点动静分离，或者有特别的需求，可以从网站下载相应的文件，放在相应的目录下提供访问，也是完全没有问题的。</p>\n<p>具体socket的绑定事件，可以从<a href=\"http://socket.io\">socket.io官方</a>的文档里找到相应的内容。</p>\n<h3 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h3><p>本文只是为了贴一段代码，做一个备忘。这部分内容还会继续深入学习，这个笔记很持续更新一段时间，直到我搞清楚webSocket为止。</p>\n<p>下面附上我自己的各组件版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">node.js    v6.9.1</div><div class=\"line\">socket.io  1.5.1</div><div class=\"line\">socket.io_client  1.4.5</div><div class=\"line\">express    4.14.0</div></pre></td></tr></table></figure>\n<p>踩过此坑，特此记录</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cj4pdkly00000r6rlzm1hrnqs","category_id":"cj4pdkly60002r6rlirywtrkw","_id":"cj4pdklyl000br6rl1juueigp"},{"post_id":"cj4pdkly40001r6rl38xvq73l","category_id":"cj4pdkly60002r6rlirywtrkw","_id":"cj4pdklyp000hr6rlmml49izg"},{"post_id":"cj4pdklya0004r6rl120ehjg6","category_id":"cj4pdklyn000dr6rl4s1ikvhi","_id":"cj4pdklyu000nr6rlxh665xmk"},{"post_id":"cj4pdklyc0005r6rlk7logjz2","category_id":"cj4pdklyn000dr6rl4s1ikvhi","_id":"cj4pdklyx000rr6rlzata7l3e"},{"post_id":"cj4pdklyf0006r6rljm23w7fw","category_id":"cj4pdklyv000or6rl64akjdri","_id":"cj4pdklz2000vr6rlxylb5mop"},{"post_id":"cj4pdklyl000cr6rlicowo3qm","category_id":"cj4pdklyy000sr6rle5dd3cr7","_id":"cj4pdklz3000zr6rlxr3u82t9"},{"post_id":"cj4pdklyo000fr6rlb6ttwtvc","category_id":"cj4pdklz2000wr6rlo788fh5g","_id":"cj4pdklz40013r6rlw358forf"},{"post_id":"cj4pdklyt000lr6rlusbqtb0u","category_id":"cj4pdklyv000or6rl64akjdri","_id":"cj4pdklz60018r6rlbvtmgpb2"},{"post_id":"cj4pdklyt000lr6rlusbqtb0u","category_id":"cj4pdklz50015r6rlu9pifzti","_id":"cj4pdklz7001ar6rlpjphrel5"}],"PostTag":[{"post_id":"cj4pdkly00000r6rlzm1hrnqs","tag_id":"cj4pdkly90003r6rll780b8a2","_id":"cj4pdklyi0009r6rl58zulnu8"},{"post_id":"cj4pdkly40001r6rl38xvq73l","tag_id":"cj4pdklyg0008r6rlgexxvw25","_id":"cj4pdklyp000gr6rll0lbisgh"},{"post_id":"cj4pdklya0004r6rl120ehjg6","tag_id":"cj4pdklyn000er6rlka9tbgw8","_id":"cj4pdklyu000mr6rll5v29hsy"},{"post_id":"cj4pdklyc0005r6rlk7logjz2","tag_id":"cj4pdklyn000er6rlka9tbgw8","_id":"cj4pdklyx000qr6rlt3lkvrs9"},{"post_id":"cj4pdklyf0006r6rljm23w7fw","tag_id":"cj4pdklyw000pr6rlha34nib5","_id":"cj4pdklz1000ur6rl9w5dvaxu"},{"post_id":"cj4pdklyl000cr6rlicowo3qm","tag_id":"cj4pdklz0000tr6rlf693cm8i","_id":"cj4pdklz3000yr6rl0p4tdkj3"},{"post_id":"cj4pdklyo000fr6rlb6ttwtvc","tag_id":"cj4pdklz3000xr6rlkgcsjy7a","_id":"cj4pdklz40012r6rl9u23s3ia"},{"post_id":"cj4pdklyq000ir6rl9ldp6689","tag_id":"cj4pdklz40011r6rlscqvy0uq","_id":"cj4pdklz50016r6rlmuatkv8t"},{"post_id":"cj4pdklyt000lr6rlusbqtb0u","tag_id":"cj4pdklz40014r6rlz3uabkgr","_id":"cj4pdklz70019r6rl9fc7vsw9"},{"post_id":"cj4pdklyt000lr6rlusbqtb0u","tag_id":"cj4pdklz60017r6rlrfu916eh","_id":"cj4pdklz7001br6rlxry34gpy"}],"Tag":[{"name":"cocosbuilder","_id":"cj4pdkly90003r6rll780b8a2"},{"name":"cocos2dx lua debug vscode","_id":"cj4pdklyg0008r6rlgexxvw25"},{"name":"Electron","_id":"cj4pdklyn000er6rlka9tbgw8"},{"name":"nodejs","_id":"cj4pdklyw000pr6rlha34nib5"},{"name":"Android","_id":"cj4pdklz0000tr6rlf693cm8i"},{"name":"网络资源","_id":"cj4pdklz3000xr6rlkgcsjy7a"},{"name":"日记","_id":"cj4pdklz40011r6rlscqvy0uq"},{"name":"webSocket","_id":"cj4pdklz40014r6rlz3uabkgr"},{"name":"socket.io","_id":"cj4pdklz60017r6rlrfu916eh"}]}}